import{j as e,I as l}from"./InputField.BmvgOzA6.js";import{r as m}from"./index.B52nOzfP.js";import{api as j}from"./api.CPfjwQVw.js";const b=[{id:1,title:"Datos del Proyecto",description:"Identidad y Logo"},{id:2,title:"Representante",description:"Datos Personales"},{id:3,title:"Ubicación",description:"Geolocalización"},{id:4,title:"Contacto y Legal",description:"Vías de comunicación"},{id:5,title:"Revisión",description:"Confirmar datos"}],G=({initialData:o,isEditing:N=!1,onSuccess:C,compact:x=!1})=>{const[n,p]=m.useState(1),[a,u]=m.useState({name:"",brand:"",logoUrl:"",sector:"Tecnología",description:"",representativeName:"",representativeId:"",representativeGender:"Otro",representativeNationality:"",representativeBirthDate:"",representativeAge:0,addressProvince:"",addressCanton:"",addressParish:"",addressComplete:"",email:"",phone:"",mobile:"",hasRuc:!1,rucNumber:"",activitiesStartDate:""}),[w,y]=m.useState(null),[h,g]=m.useState(null),[k,S]=m.useState(!1),[c,F]=m.useState({}),[P,v]=m.useState(!1),[D,R]=m.useState([]);m.useEffect(()=>{if(o&&(u(s=>({...s,...o,representativeBirthDate:o.representativeBirthDate?new Date(o.representativeBirthDate).toISOString().split("T")[0]:"",activitiesStartDate:o.activitiesStartDate?new Date(o.activitiesStartDate).toISOString().split("T")[0]:""})),o.logoUrl)){const s=o.logoUrl.startsWith("http")?o.logoUrl:`${"http://localhost:3000/api".replace("/api","")||"http://localhost:3000"}${o.logoUrl}`;g(s)}},[o]),m.useEffect(()=>{if(a.representativeBirthDate){const s=new Date(a.representativeBirthDate),r=new Date;let t=r.getFullYear()-s.getFullYear();const d=r.getMonth()-s.getMonth();(d<0||d===0&&r.getDate()<s.getDate())&&t--,u(f=>({...f,representativeAge:t}))}},[a.representativeBirthDate]),m.useEffect(()=>{if(!a.name)return;const s=a.name.toLowerCase(),r=[{keywords:["alimento","comida","restaurante","postre","dulce","café","pan","fruta","gastronomia"],sector:"Alimentos"},{keywords:["app","software","web","tecnología","digital","system","red","computo"],sector:"Tecnología"},{keywords:["ropa","textil","moda","prenda","calzado","zapato"],sector:"Producción / Textil"},{keywords:["consultoría","asesoría","servicio","limpieza","mantenimiento","soporte"],sector:"Servicios"},{keywords:["granja","cultivo","planta","siembra","fruta","verdura","agrícola","campo"],sector:"Agrícola"},{keywords:["hotel","viaje","turístico","guía","hospedaje"],sector:"Turismo"},{keywords:["clase","curso","tutor","enseñanza","educación","escuela"],sector:"Educación"},{keywords:["medicina","doctor","salud","clínica","fisioterap"],sector:"Salud"},{keywords:["transporte","mudanza","logística","entrega","delivery"],sector:"Transporte"},{keywords:["artesanía","manualidad","decoración","arte"],sector:"Artesanías"}];for(const t of r)if(t.keywords.some(d=>s.includes(d))){u(d=>({...d,sector:t.sector}));break}},[a.name]);const i=s=>{const{name:r,value:t,type:d}=s.target,f=d==="checkbox"?s.target.checked:t;u(M=>({...M,[r]:f}))},E=s=>{if(s.target.files&&s.target.files[0]){const r=s.target.files[0];y(r),g(URL.createObjectURL(r))}},L=()=>{y(null),g(null),u(s=>({...s,logoUrl:""}))},A=s=>{const r={},t=[];return s===1?(a.name||(r.name="El nombre del proyecto es obligatorio",t.push("Nombre del Proyecto")),a.brand||(r.brand="La marca o nombre comercial es obligatoria",t.push("Marca / Nombre Comercial"))):s===2?(a.representativeName||(r.representativeName="El nombre del representante es obligatorio",t.push("Nombre del Representante")),a.representativeId||(r.representativeId="La identificación es obligatoria",t.push("Cédula / Identificación"))):s===3?(a.addressProvince||(r.addressProvince="La provincia es obligatoria",t.push("Provincia")),a.addressCanton||(r.addressCanton="El cantón es obligatorio",t.push("Cantón")),a.addressParish||(r.addressParish="La parroquia es obligatoria",t.push("Parroquia")),a.addressComplete||(r.addressComplete="La dirección completa es obligatoria",t.push("Dirección Completa"))):s===4&&(a.email||(r.email="El correo electrónico es obligatorio",t.push("Correo Electrónico")),a.mobile||(r.mobile="El número de celular es obligatorio",t.push("Número de Celular")),a.hasRuc&&!a.rucNumber&&(r.rucNumber="El número de RUC es obligatorio si tiene RUC",t.push("Número de RUC")),a.activitiesStartDate||(r.activitiesStartDate="La fecha de inicio de actividades es obligatoria",t.push("Fecha de Inicio de Actividades"))),F(r),R(t),t.length===0},I=()=>{A(n)?(p(s=>Math.min(s+1,5)),window.scrollTo(0,0)):(v(!0),setTimeout(()=>{const s=document.querySelector(".border-red-500");s&&s.scrollIntoView({behavior:"smooth",block:"center"})},100))},T=()=>p(s=>Math.max(s-1,1)),U=async()=>{S(!0);try{let s=a.logoUrl;if(w)try{s=(await j.uploadImage("/upload/image",w,{type:"logo"})).url}catch(d){console.error("Error uploading logo",d)}const r=parseInt(String(a.representativeAge)),t={...a,logoUrl:s,description:a.description||"Sin descripción",sector:a.sector||"General",representativeAge:isNaN(r)?null:r,activitiesStartDate:a.activitiesStartDate?new Date(a.activitiesStartDate).toISOString():null,representativeBirthDate:a.representativeBirthDate?new Date(a.representativeBirthDate).toISOString():null};N&&o?.id?await j.updateEntrepreneurship(o.id,t):await j.createEntrepreneurship(t),window.dispatchEvent(new CustomEvent("entrepreneurship-success")),C?C():window.location.href="/entrepreneurship"}catch(s){console.error(s),alert("Error al guardar el emprendimiento")}finally{S(!1)}},q=()=>{switch(n){case 1:return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-blue-50 p-4 rounded-lg text-blue-800 text-sm mb-6",children:"Completa los datos básicos de identidad de tu proyecto."}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(l,{label:"Nombre del Proyecto *",name:"name",value:a.name,onChange:i,placeholder:"Ej. Ecofood",required:!0,error:c.name}),e.jsx(l,{label:"Marca / Nombre Comercial *",name:"brand",value:a.brand,onChange:i,placeholder:"Ej. Ecofood S.A.",required:!0,error:c.brand}),e.jsx(l,{label:"Sector del Emprendimiento *",name:"sector",select:!0,options:[{label:"Tecnología",value:"Tecnología"},{label:"Alimentos",value:"Alimentos"},{label:"Comercio",value:"Comercio"},{label:"Servicios",value:"Servicios"},{label:"Producción",value:"Producción"},{label:"Producción / Textil",value:"Producción / Textil"},{label:"Agrícola",value:"Agrícola"},{label:"Turismo",value:"Turismo"},{label:"Artesanías",value:"Artesanías"},{label:"Educación",value:"Educación"},{label:"Salud",value:"Salud"},{label:"Transporte",value:"Transporte"},{label:"Otro",value:"Otro"}],value:a.sector,onChange:i}),e.jsx("p",{className:"text-[10px] text-slate-400 mt-1 italic",children:"El sector se detecta automáticamente según el nombre, pero puedes cambiarlo."})]}),e.jsx("div",{className:"flex flex-col items-center justify-center p-6 border-2 border-dashed border-slate-300 rounded-xl bg-[#FAFAFA] hover:bg-slate-100 transition-colors",children:h?e.jsxs("div",{className:"text-center w-full",children:[e.jsx("img",{src:h,alt:"Preview",className:"h-40 mx-auto object-contain mb-4 bg-white p-2 rounded shadow-sm"}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsxs("label",{className:"btn btn-sm btn-outline cursor-pointer",children:["Cambiar Logo",e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:E})]}),e.jsx("button",{onClick:L,className:"btn btn-sm btn-error btn-outline",children:"Eliminar"})]})]}):e.jsxs("label",{className:"cursor-pointer text-center w-full py-8",children:[e.jsx("div",{className:"bg-white p-4 rounded-full shadow-sm inline-block mb-3",children:e.jsx("svg",{className:"w-8 h-8 text-primary-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("div",{className:"font-semibold text-slate-700",children:"Subir Logo"}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"Recomendado: 500x500px"}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:E})]})})]});case 2:return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(l,{label:"Nombre Completo *",name:"representativeName",value:a.representativeName,onChange:i,required:!0,error:c.representativeName}),e.jsx(l,{label:"Cédula / Identificación *",name:"representativeId",value:a.representativeId,onChange:i,required:!0,error:c.representativeId}),e.jsx(l,{label:"Género *",name:"representativeGender",select:!0,options:[{label:"Masculino",value:"Masculino"},{label:"Femenino",value:"Femenino"},{label:"Otro",value:"Otro"}],value:a.representativeGender,onChange:i}),e.jsx(l,{label:"Nacionalidad *",name:"representativeNationality",value:a.representativeNationality,onChange:i}),e.jsx(l,{label:"Fecha de Nacimiento",type:"date",name:"representativeBirthDate",value:a.representativeBirthDate,onChange:i}),e.jsx(l,{label:"Edad Calculada",value:a.representativeAge,readOnly:!0,disabled:!0,className:"bg-[#FAFAFA]"})]})});case 3:return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx(l,{label:"Provincia *",name:"addressProvince",value:a.addressProvince,onChange:i,required:!0,error:c.addressProvince}),e.jsx(l,{label:"Cantón *",name:"addressCanton",value:a.addressCanton,onChange:i,required:!0,error:c.addressCanton}),e.jsx(l,{label:"Parroquia *",name:"addressParish",value:a.addressParish,onChange:i,required:!0,error:c.addressParish}),e.jsx("div",{className:"col-span-full",children:e.jsx(l,{label:"Dirección Completa *",name:"addressComplete",value:a.addressComplete,onChange:i,multiline:!0,rows:4,placeholder:"Indica calle principal, secundaria, numeración y puntos de referencia...",required:!0,error:c.addressComplete})})]})});case 4:return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(l,{label:"Correo Electrónico *",type:"email",name:"email",value:a.email,onChange:i,required:!0,error:c.email}),e.jsx(l,{label:"Celular *",type:"tel",name:"mobile",value:a.mobile,onChange:i,required:!0,error:c.mobile}),e.jsx(l,{label:"Teléfono Convencional",type:"tel",name:"phone",value:a.phone,onChange:i}),e.jsxs("div",{className:"flex flex-col justify-center",children:[e.jsx("label",{className:"font-semibold text-slate-700 mb-2",children:"¿Dispone de RUC?"}),e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"hasRuc",className:"radio radio-primary",checked:a.hasRuc===!0,onChange:()=>u(s=>({...s,hasRuc:!0}))})," Sí"]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"hasRuc",className:"radio radio-primary",checked:a.hasRuc===!1,onChange:()=>u(s=>({...s,hasRuc:!1,rucNumber:""}))})," No"]})]})]}),a.hasRuc&&e.jsx("div",{className:"animate-in fade-in slide-in-from-top-1",children:e.jsx(l,{label:"Número de RUC *",name:"rucNumber",value:a.rucNumber,onChange:i,placeholder:"Ej. 1790000000001",required:!0,error:c.rucNumber})}),e.jsx(l,{label:"Fecha Inicio Actividades *",type:"date",name:"activitiesStartDate",value:a.activitiesStartDate,onChange:i,required:!0,error:c.activitiesStartDate})]})});case 5:return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-[#FAFAFA] p-6 rounded-xl border border-slate-100",children:[e.jsxs("h4",{className:"font-black text-slate-800 border-b pb-2 mb-4 flex justify-between border-slate-100 uppercase tracking-tighter text-sm",children:[e.jsx("span",{children:"Datos del Proyecto"}),e.jsx("button",{onClick:()=>p(1),className:"text-indigo-600 text-xs hover:underline",children:"Editar"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400 font-bold uppercase text-[10px]",children:"Nombre:"})," ",e.jsx("span",{className:"font-semibold bg-white px-3 py-2 rounded-lg border border-slate-100 block mt-1",children:a.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400 font-bold uppercase text-[10px]",children:"Marca:"})," ",e.jsx("span",{className:"font-semibold bg-white px-3 py-2 rounded-lg border border-slate-100 block mt-1",children:a.brand})]}),h&&e.jsxs("div",{className:"col-span-2 mt-2",children:[e.jsx("span",{className:"text-slate-400 font-bold uppercase text-[10px] block mb-1",children:"Logo:"}),e.jsx("img",{src:h,className:"h-20 object-contain bg-white p-2 rounded-lg border border-slate-100"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-[#FAFAFA] p-6 rounded-xl border border-slate-100",children:[e.jsxs("h4",{className:"font-black text-slate-800 border-b pb-2 mb-4 flex justify-between border-slate-100 uppercase tracking-tighter text-sm",children:[e.jsx("span",{children:"Representante"}),e.jsx("button",{onClick:()=>p(2),className:"text-indigo-600 text-xs hover:underline",children:"Editar"})]}),e.jsxs("ul",{className:"space-y-3 text-sm",children:[e.jsxs("li",{children:[e.jsx("span",{className:"text-slate-400 font-bold uppercase text-[10px] block",children:"Nombre:"})," ",e.jsx("span",{className:"font-semibold",children:a.representativeName})]}),e.jsxs("li",{children:[e.jsx("span",{className:"text-slate-400 font-bold uppercase text-[10px] block",children:"Cédula:"})," ",e.jsx("span",{className:"font-semibold",children:a.representativeId})]}),e.jsxs("li",{children:[e.jsx("span",{className:"text-slate-400 font-bold uppercase text-[10px] block",children:"Edad:"})," ",e.jsxs("span",{className:"font-semibold",children:[a.representativeAge," años"]})]})]})]}),e.jsxs("div",{className:"bg-[#FAFAFA] p-6 rounded-xl border border-slate-100",children:[e.jsxs("h4",{className:"font-black text-slate-800 border-b pb-2 mb-4 flex justify-between border-slate-100 uppercase tracking-tighter text-sm",children:[e.jsx("span",{children:"Ubicación y Contacto"}),e.jsx("button",{onClick:()=>p(3),className:"text-indigo-600 text-xs hover:underline",children:"Editar"})]}),e.jsxs("ul",{className:"space-y-3 text-sm",children:[e.jsxs("li",{children:[e.jsx("span",{className:"text-slate-400 font-bold uppercase text-[10px] block",children:"Provincia/Cantón:"})," ",e.jsxs("span",{className:"font-semibold",children:[a.addressProvince," / ",a.addressCanton]})]}),e.jsxs("li",{children:[e.jsx("span",{className:"text-slate-400 font-bold uppercase text-[10px] block",children:"Email:"})," ",e.jsx("span",{className:"font-semibold",children:a.email})]}),e.jsxs("li",{children:[e.jsx("span",{className:"text-slate-400 font-bold uppercase text-[10px] block",children:"Celular:"})," ",e.jsx("span",{className:"font-semibold",children:a.mobile})]}),a.hasRuc&&e.jsxs("li",{children:[e.jsx("span",{className:"text-slate-400 font-bold uppercase text-[10px] block",children:"RUC:"})," ",e.jsx("span",{className:"font-semibold",children:a.rucNumber})]})]})]})]})]});default:return null}};return e.jsxs("div",{className:"flex flex-col space-y-10",children:[e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"flex justify-between items-center max-w-6xl mx-auto px-4 py-2 overflow-x-auto",children:b.map((s,r)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full border-2 font-bold transition-all ${n===s.id?"border-indigo-600 bg-indigo-600 text-white":n>s.id?"border-green-500 bg-green-500 text-white":"border-slate-300 text-slate-400"}`,onClick:()=>{(A(s.id-1)||s.id<n)&&p(s.id)},children:n>s.id?"✓":s.id}),e.jsx("span",{className:`ml-2 text-sm font-bold whitespace-nowrap hidden md:block ${n===s.id?"text-indigo-900":"text-slate-500"}`,children:s.title}),r<b.length-1&&e.jsx("div",{className:`w-12 h-0.5 mx-4 ${n>s.id?"bg-green-500":"bg-slate-300"}`})]},s.id))})}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:`${x?"":"max-w-4xl mx-auto card overflow-hidden border-indigo-100/30"}`,children:[e.jsxs("div",{className:x?"py-4":"p-8",children:[!x&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-2xl font-black text-slate-900 tracking-tight mb-2",children:b[n-1].title}),e.jsx("p",{className:"text-slate-500 font-medium",children:b[n-1].description})]}),q()]}),e.jsxs("div",{className:`${x?"px-0":"px-8"} py-6 bg-[#FAFAFA]/50 border-t border-slate-100 flex justify-between items-center`,children:[e.jsx("button",{onClick:T,disabled:n===1,className:`btn btn-secondary ${n===1?"invisible":""}`,children:"Atrás"}),n<5?e.jsx("button",{onClick:I,className:"btn btn-primary px-10",children:"Siguiente"}):e.jsx("button",{onClick:U,disabled:k,className:"btn bg-green-600 hover:bg-green-700 text-white px-10 shadow-lg shadow-green-200",children:k?"Guardando...":N?"Actualizar Emprendimiento":"Finalizar y Guardar"})]})]})}),P&&e.jsxs("div",{className:"modal modal-open",children:[e.jsxs("div",{className:"modal-box bg-white rounded-[20px] p-0 overflow-hidden max-w-md shadow-2xl border border-slate-100",children:[e.jsxs("div",{className:"p-6 bg-red-50 border-b border-red-100 flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 text-red-600 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("h3",{className:"text-lg font-black text-red-900",children:"Campos Obligatorios Faltantes"})]}),e.jsxs("div",{className:"p-8",children:[e.jsx("p",{className:"text-slate-600 mb-6 font-medium",children:"Por favor complete los siguientes campos obligatorios para continuar:"}),e.jsx("ul",{className:"space-y-3",children:D.map((s,r)=>e.jsxs("li",{className:"flex items-center gap-3 text-slate-800 font-bold bg-[#FAFAFA] p-3 rounded-xl border border-slate-100",children:[e.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full"}),s]},r))}),e.jsx("div",{className:"mt-8",children:e.jsx("button",{onClick:()=>v(!1),className:"w-full btn bg-slate-900 hover:bg-slate-800 text-white border-none h-14 rounded-xl font-black transition-all active:scale-95",children:"Entendido, completaré los datos"})})]})]}),e.jsx("form",{method:"dialog",className:"modal-backdrop",children:e.jsx("button",{onClick:()=>v(!1),children:"close"})})]})]})};export{G as EntrepreneurshipWizard};
