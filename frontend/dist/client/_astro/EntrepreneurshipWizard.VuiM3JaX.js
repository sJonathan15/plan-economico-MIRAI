import{j as e,I as l}from"./InputField.CDFBDmbB.js";import{r as d}from"./index.B52nOzfP.js";import{a as v}from"./api.DUBSwrnZ.js";const x=[{id:1,title:"Datos del Proyecto",description:"Identidad y Logo"},{id:2,title:"Representante",description:"Datos Personales"},{id:3,title:"Ubicación",description:"Geolocalización"},{id:4,title:"Contacto y Legal",description:"Vías de comunicación"},{id:5,title:"Revisión",description:"Confirmar datos"}],B=({initialData:n,isEditing:j=!1,onSuccess:f,compact:p=!1})=>{const[i,u]=d.useState(1),[a,m]=d.useState({name:"",brand:"",logoUrl:"",sector:"Tecnología",description:"",representativeName:"",representativeId:"",representativeGender:"Otro",representativeNationality:"",representativeBirthDate:"",representativeAge:0,addressProvince:"",addressCanton:"",addressParish:"",addressComplete:"",email:"",phone:"",mobile:"",hasRuc:!1,rucNumber:"",activitiesStartDate:""}),[N,w]=d.useState(null),[h,b]=d.useState(null),[y,C]=d.useState(!1);d.useEffect(()=>{if(n&&(m(s=>({...s,...n,representativeBirthDate:n.representativeBirthDate?new Date(n.representativeBirthDate).toISOString().split("T")[0]:"",activitiesStartDate:n.activitiesStartDate?new Date(n.activitiesStartDate).toISOString().split("T")[0]:""})),n.logoUrl)){const s=n.logoUrl.startsWith("http")?n.logoUrl:`${"http://localhost:3000/api".replace("/api","")||"http://localhost:3000"}${n.logoUrl}`;b(s)}},[n]),d.useEffect(()=>{if(a.representativeBirthDate){const s=new Date(a.representativeBirthDate),r=new Date;let c=r.getFullYear()-s.getFullYear();const o=r.getMonth()-s.getMonth();(o<0||o===0&&r.getDate()<s.getDate())&&c--,m(g=>({...g,representativeAge:c}))}},[a.representativeBirthDate]),d.useEffect(()=>{if(!a.name)return;const s=a.name.toLowerCase(),r=[{keywords:["alimento","comida","restaurante","postre","dulce","café","pan","fruta","gastronomia"],sector:"Gastronomía"},{keywords:["app","software","web","tecnología","digital","system","red","computo"],sector:"Tecnología"},{keywords:["ropa","textil","moda","prenda","calzado","zapato"],sector:"Producción / Textil"},{keywords:["consultoría","asesoría","servicio","limpieza","mantenimiento","soporte"],sector:"Servicios"},{keywords:["granja","cultivo","planta","siembra","fruta","verdura","agrícola","campo"],sector:"Agrícola"},{keywords:["hotel","viaje","turístico","guía","hospedaje"],sector:"Turismo"},{keywords:["clase","curso","tutor","enseñanza","educación","escuela"],sector:"Educación"},{keywords:["medicina","doctor","salud","clínica","fisioterap"],sector:"Salud"},{keywords:["transporte","mudanza","logística","entrega","delivery"],sector:"Transporte"},{keywords:["artesanía","manualidad","decoración","arte"],sector:"Artesanías"}];for(const c of r)if(c.keywords.some(o=>s.includes(o))){m(o=>({...o,sector:c.sector}));break}},[a.name]);const t=s=>{const{name:r,value:c,type:o}=s.target,g=o==="checkbox"?s.target.checked:c;m(I=>({...I,[r]:g}))},S=s=>{if(s.target.files&&s.target.files[0]){const r=s.target.files[0];w(r),b(URL.createObjectURL(r))}},E=()=>{w(null),b(null),m(s=>({...s,logoUrl:""}))},k=s=>{switch(s){case 1:return!!a.name&&!!a.brand;case 2:return!!a.representativeName&&!!a.representativeId;case 3:return!!a.addressProvince&&!!a.addressCanton&&!!a.addressParish&&!!a.addressComplete;case 4:return!!a.email&&!!a.mobile&&(!a.hasRuc||!!a.rucNumber);default:return!0}},P=()=>{k(i)?(u(s=>Math.min(s+1,5)),window.scrollTo(0,0)):alert("Por favor completa los campos obligatorios (*)")},D=()=>u(s=>Math.max(s-1,1)),R=async()=>{C(!0);try{let s=a.logoUrl;if(N)try{s=(await v.uploadImage("/upload/image",N,{type:"logo"})).url}catch(o){console.error("Error uploading logo",o)}const r=parseInt(String(a.representativeAge)),c={...a,logoUrl:s,description:a.description||"Sin descripción",sector:a.sector||"General",representativeAge:isNaN(r)?null:r,activitiesStartDate:a.activitiesStartDate?new Date(a.activitiesStartDate).toISOString():null,representativeBirthDate:a.representativeBirthDate?new Date(a.representativeBirthDate).toISOString():null};j&&n?.id?await v.updateEntrepreneurship(n.id,c):await v.createEntrepreneurship(c),window.dispatchEvent(new CustomEvent("entrepreneurship-success")),f?f():window.location.href="/entrepreneurship"}catch(s){console.error(s),alert("Error al guardar el emprendimiento")}finally{C(!1)}},T=()=>{switch(i){case 1:return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-blue-50 p-4 rounded-lg text-blue-800 text-sm mb-6",children:"Completa los datos básicos de identidad de tu proyecto."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(l,{label:"Nombre del Proyecto *",name:"name",value:a.name,onChange:t,placeholder:"Ej. Ecofood",required:!0}),e.jsx(l,{label:"Marca / Nombre Comercial *",name:"brand",value:a.brand,onChange:t,placeholder:"Ej. Ecofood S.A.",required:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"label font-bold text-slate-700 text-xs uppercase tracking-wider mb-1",children:"Sector del Emprendimiento *"}),e.jsxs("select",{name:"sector",className:"select input w-full border-slate-200 rounded-xl bg-white shadow-sm focus:border-primary-500 focus:ring-0 transition-all text-base",value:a.sector,onChange:t,children:[e.jsx("option",{value:"Tecnología",children:"Tecnología"}),e.jsx("option",{value:"Gastronomía",children:"Gastronomía"}),e.jsx("option",{value:"Comercio",children:"Comercio"}),e.jsx("option",{value:"Servicios",children:"Servicios"}),e.jsx("option",{value:"Producción",children:"Producción"}),e.jsx("option",{value:"Producción / Textil",children:"Producción / Textil"}),e.jsx("option",{value:"Agrícola",children:"Agrícola"}),e.jsx("option",{value:"Turismo",children:"Turismo"}),e.jsx("option",{value:"Artesanías",children:"Artesanías"}),e.jsx("option",{value:"Educación",children:"Educación"}),e.jsx("option",{value:"Salud",children:"Salud"}),e.jsx("option",{value:"Transporte",children:"Transporte"}),e.jsx("option",{value:"Otro",children:"Otro"})]}),e.jsx("p",{className:"text-[10px] text-slate-400 mt-1 italic",children:"El sector se detecta automáticamente según el nombre, pero puedes cambiarlo."})]})]}),e.jsx("div",{className:"flex flex-col items-center justify-center p-6 border-2 border-dashed border-slate-300 rounded-xl bg-slate-50 hover:bg-slate-100 transition-colors",children:h?e.jsxs("div",{className:"text-center w-full",children:[e.jsx("img",{src:h,alt:"Preview",className:"h-40 mx-auto object-contain mb-4 bg-white p-2 rounded shadow-sm"}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsxs("label",{className:"btn btn-sm btn-outline cursor-pointer",children:["Cambiar Logo",e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:S})]}),e.jsx("button",{onClick:E,className:"btn btn-sm btn-error btn-outline",children:"Eliminar"})]})]}):e.jsxs("label",{className:"cursor-pointer text-center w-full py-8",children:[e.jsx("div",{className:"bg-white p-4 rounded-full shadow-sm inline-block mb-3",children:e.jsx("svg",{className:"w-8 h-8 text-primary-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("div",{className:"font-semibold text-slate-700",children:"Subir Logo"}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"Recomendado: 500x500px"}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:S})]})})]})]});case 2:return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(l,{label:"Nombre Completo *",name:"representativeName",value:a.representativeName,onChange:t,required:!0}),e.jsx(l,{label:"Cédula / Identificación *",name:"representativeId",value:a.representativeId,onChange:t,required:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"label font-semibold text-slate-700",children:"Género *"}),e.jsxs("select",{name:"representativeGender",className:"select input w-full border-slate-300",value:a.representativeGender,onChange:t,children:[e.jsx("option",{children:"Masculino"}),e.jsx("option",{children:"Femenino"}),e.jsx("option",{children:"Otro"})]})]}),e.jsx(l,{label:"Nacionalidad *",name:"representativeNationality",value:a.representativeNationality,onChange:t}),e.jsx(l,{label:"Fecha de Nacimiento",type:"date",name:"representativeBirthDate",value:a.representativeBirthDate,onChange:t}),e.jsxs("div",{children:[e.jsx("label",{className:"label font-semibold text-slate-700",children:"Edad Calculada"}),e.jsx("input",{className:"input w-full bg-slate-100 border-slate-300",value:a.representativeAge,readOnly:!0})]})]})});case 3:return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx(l,{label:"Provincia *",name:"addressProvince",value:a.addressProvince,onChange:t,required:!0}),e.jsx(l,{label:"Cantón *",name:"addressCanton",value:a.addressCanton,onChange:t,required:!0}),e.jsx(l,{label:"Parroquia *",name:"addressParish",value:a.addressParish,onChange:t,required:!0}),e.jsx("div",{className:"col-span-full",children:e.jsx(l,{label:"Dirección Completa",name:"addressComplete",value:a.addressComplete,onChange:t,multiline:!0,rows:4,placeholder:"Indica calle principal, secundaria, numeración y puntos de referencia...",required:!0})})]})});case 4:return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(l,{label:"Correo Electrónico *",type:"email",name:"email",value:a.email,onChange:t,required:!0}),e.jsx(l,{label:"Celular *",type:"tel",name:"mobile",value:a.mobile,onChange:t,required:!0}),e.jsx(l,{label:"Teléfono Convencional",type:"tel",name:"phone",value:a.phone,onChange:t}),e.jsxs("div",{className:"flex flex-col justify-center",children:[e.jsx("label",{className:"font-semibold text-slate-700 mb-2",children:"¿Dispone de RUC?"}),e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"hasRuc",className:"radio radio-primary",checked:a.hasRuc===!0,onChange:()=>m(s=>({...s,hasRuc:!0}))})," Sí"]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"hasRuc",className:"radio radio-primary",checked:a.hasRuc===!1,onChange:()=>m(s=>({...s,hasRuc:!1,rucNumber:""}))})," No"]})]})]}),a.hasRuc&&e.jsx("div",{className:"animate-in fade-in slide-in-from-top-1",children:e.jsx(l,{label:"Número de RUC *",name:"rucNumber",value:a.rucNumber,onChange:t,placeholder:"Ej. 1790000000001",required:!0})}),e.jsx(l,{label:"Fecha Inicio Actividades",type:"date",name:"activitiesStartDate",value:a.activitiesStartDate,onChange:t})]})});case 5:return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-slate-50 p-6 rounded-xl border border-slate-200",children:[e.jsxs("h4",{className:"font-bold text-slate-800 border-b pb-2 mb-4 flex justify-between",children:[e.jsx("span",{children:"Datos del Proyecto"}),e.jsx("button",{onClick:()=>u(1),className:"text-primary-600 text-sm hover:underline",children:"Editar"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Nombre:"})," ",e.jsx("span",{className:"font-medium bg-white px-2 py-1 rounded border border-slate-100 block",children:a.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Marca:"})," ",e.jsx("span",{className:"font-medium bg-white px-2 py-1 rounded border border-slate-100 block",children:a.brand})]}),h&&e.jsxs("div",{className:"col-span-2 mt-2",children:[e.jsx("span",{className:"text-slate-500 block mb-1",children:"Logo:"}),e.jsx("img",{src:h,className:"h-16 object-contain bg-white p-1 rounded border"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-slate-50 p-6 rounded-xl border border-slate-200",children:[e.jsxs("h4",{className:"font-bold text-slate-800 border-b pb-2 mb-4 flex justify-between",children:[e.jsx("span",{children:"Representante"}),e.jsx("button",{onClick:()=>u(2),className:"text-primary-600 text-sm hover:underline",children:"Editar"})]}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsxs("li",{children:[e.jsx("span",{className:"text-slate-500 block",children:"Nombre:"})," ",a.representativeName]}),e.jsxs("li",{children:[e.jsx("span",{className:"text-slate-500 block",children:"Cédula:"})," ",a.representativeId]}),e.jsxs("li",{children:[e.jsx("span",{className:"text-slate-500 block",children:"Edad:"})," ",a.representativeAge," años"]})]})]}),e.jsxs("div",{className:"bg-slate-50 p-6 rounded-xl border border-slate-200",children:[e.jsxs("h4",{className:"font-bold text-slate-800 border-b pb-2 mb-4 flex justify-between",children:[e.jsx("span",{children:"Ubicación y Contacto"}),e.jsx("button",{onClick:()=>u(3),className:"text-primary-600 text-sm hover:underline",children:"Editar"})]}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsxs("li",{children:[e.jsx("span",{className:"text-slate-500 block",children:"Provincia/Cantón:"})," ",a.addressProvince," / ",a.addressCanton]}),e.jsxs("li",{children:[e.jsx("span",{className:"text-slate-500 block",children:"Email:"})," ",a.email]}),e.jsxs("li",{children:[e.jsx("span",{className:"text-slate-500 block",children:"Celular:"})," ",a.mobile]}),a.hasRuc&&e.jsxs("li",{children:[e.jsx("span",{className:"text-slate-500 block",children:"RUC:"})," ",a.rucNumber]})]})]})]})]});default:return null}};return e.jsxs("div",{className:"flex flex-col space-y-8",children:[e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"flex justify-between items-center max-w-4xl mx-auto px-4 py-2 overflow-x-auto",children:x.map((s,r)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full border-2 font-bold transition-all ${i===s.id?"border-indigo-600 bg-indigo-600 text-white":i>s.id?"border-green-500 bg-green-500 text-white":"border-slate-300 text-slate-400"}`,onClick:()=>{(k(s.id-1)||s.id<i)&&u(s.id)},children:i>s.id?"✓":s.id}),e.jsx("span",{className:`ml-2 text-sm font-bold whitespace-nowrap hidden md:block ${i===s.id?"text-indigo-900":"text-slate-500"}`,children:s.title}),r<x.length-1&&e.jsx("div",{className:`w-12 h-0.5 mx-4 ${i>s.id?"bg-green-500":"bg-slate-300"}`})]},s.id))})}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:`${p?"":"max-w-4xl mx-auto bg-white rounded-2xl shadow-xl shadow-slate-200/50 border border-slate-100"} overflow-hidden`,children:[e.jsxs("div",{className:p?"py-4":"p-8",children:[!p&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-2xl font-black text-slate-900 tracking-tight mb-2",children:x[i-1].title}),e.jsx("p",{className:"text-slate-500 font-medium",children:x[i-1].description})]}),T()]}),e.jsxs("div",{className:`${p?"px-0":"px-8"} py-6 bg-slate-50 border-t border-slate-100 flex justify-between items-center`,children:[e.jsx("button",{onClick:D,disabled:i===1,className:`btn btn-secondary ${i===1?"invisible":""}`,children:"Atrás"}),i<5?e.jsx("button",{onClick:P,className:"btn btn-primary px-10",children:"Siguiente"}):e.jsx("button",{onClick:R,disabled:y,className:"btn bg-green-600 hover:bg-green-700 text-white px-10 shadow-lg shadow-green-200",children:y?"Guardando...":j?"Actualizar Emprendimiento":"Finalizar y Guardar"})]})]})})]})};export{B as EntrepreneurshipWizard};
