import{j as e,I as n}from"./InputField.BmvgOzA6.js";import{r as i}from"./index.B52nOzfP.js";import{api as ae}from"./api.CPfjwQVw.js";const Pe=({isOpen:P,onClose:c,onConfirm:v,title:A="Confirmar Acción de Seguridad",message:y="Para continuar, por favor ingresa tu contraseña de inicio de sesión. Esta acción no se puede deshacer.",actionLabel:L="Confirmar y Eliminar"})=>{const[b,S]=i.useState(""),[h,j]=i.useState(!1),[Q,W]=i.useState(null);if(!P)return null;const z=async I=>{I.preventDefault(),j(!0),W(null);try{await ae.verifyPassword(b),v(),S(""),c()}catch(p){W(p.message||"Contraseña incorrecta")}finally{j(!1)}};return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"modal-box bg-white p-0 rounded-[24px] max-w-md w-full overflow-hidden shadow-2xl transition-all duration-300",children:[e.jsxs("div",{className:"p-6 border-b flex justify-between items-center bg-slate-50/50",children:[e.jsx("h3",{className:"text-xl font-black text-slate-900",children:A}),e.jsx("button",{type:"button",onClick:c,className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-slate-100 text-slate-400 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-8",children:[e.jsx("div",{className:"w-12 h-12 bg-red-50 text-red-600 rounded-full flex items-center justify-center mb-6",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 00-2 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),e.jsx("p",{className:"text-slate-500 font-medium mb-6 leading-relaxed",children:y}),e.jsxs("form",{onSubmit:z,className:"space-y-4",children:[e.jsx(n,{label:"Tu Contraseña",type:"password",value:b,onChange:I=>S(I.target.value),placeholder:"••••••••",required:!0,error:Q||void 0,autoFocus:!0}),e.jsxs("div",{className:"flex flex-col gap-3 pt-2",children:[e.jsx("button",{type:"submit",disabled:h,className:"w-full h-14 bg-red-600 hover:bg-red-700 text-white font-black rounded-xl shadow-lg shadow-red-200 transition-all flex items-center justify-center gap-2 active:scale-95 disabled:opacity-50",children:h?e.jsx("span",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):e.jsx("span",{children:L})}),e.jsx("button",{type:"button",onClick:c,className:"w-full h-14 text-slate-500 font-bold hover:bg-[#FAFAFA] rounded-xl transition-all",children:"Cancelar"})]})]})]})]})})},Ae=({isOpen:P,onClose:c,title:v,message:A,icon:y})=>P?e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"modal-box bg-white p-0 rounded-[24px] max-w-md w-full overflow-hidden shadow-2xl",children:[e.jsxs("div",{className:"p-6 border-b flex justify-between items-center bg-slate-50/50",children:[e.jsx("h3",{className:"text-xl font-black text-slate-900",children:v}),e.jsx("button",{type:"button",onClick:c,className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-slate-100 text-slate-400 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-8 text-center sm:text-left",children:[e.jsx("div",{className:"flex justify-center sm:justify-start mb-6",children:y||e.jsx("div",{className:"w-12 h-12 bg-indigo-50 text-indigo-600 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),e.jsx("p",{className:"text-slate-500 font-medium mb-8 leading-relaxed",children:A}),e.jsx("button",{type:"button",onClick:c,className:"w-full h-14 bg-indigo-600 hover:bg-indigo-700 text-white font-black rounded-xl shadow-xl shadow-indigo-500/10 transition-all flex items-center justify-center active:scale-95",children:"Entendido"})]})]})}):null,de=({label:P,value:c,options:v,onChange:A})=>{const L=v.find(b=>b.value===c)?.recommended;return e.jsxs("div",{className:"flex flex-col gap-1.5 min-w-[200px] flex-1 group",children:[e.jsxs("div",{className:"flex justify-between items-center mb-0.5",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest leading-none",children:P}),L&&e.jsxs("div",{className:"flex items-center gap-1 px-2 py-0.5 bg-indigo-50 border border-indigo-100 rounded-full animate-in fade-in zoom-in duration-300",children:[e.jsx("svg",{className:"w-2.5 h-2.5 text-indigo-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),e.jsx("span",{className:"text-[8px] font-bold text-indigo-600 uppercase tracking-tighter",children:"Recomendado"})]})]}),e.jsxs("div",{className:"relative group/select",children:[e.jsx("select",{value:c,onChange:A,className:"w-full px-4 py-3 bg-white border border-[#CBD5E1] hover:border-[#94A3B8] rounded-xl focus:ring-2 focus:ring-[#6366F1]/25 focus:border-[#6366F1] outline-none transition-all text-sm font-semibold text-slate-700 appearance-none shadow-sm",children:v.map(b=>e.jsxs("option",{value:b.value,children:[b.label,b.recommended?" (Recomendado)":""]},b.value))}),e.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-[#64748B] group-hover/select:text-[#6366F1] group-focus-within/select:text-[#6366F1] transition-colors",children:e.jsx("svg",{className:"w-4 h-4 transition-transform group-hover/select:translate-y-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M19 9l-7 7-7-7"})})})]})]})},se=[{id:1,title:"Descripción del Negocio",description:"Resumen, actividad y enfoque"},{id:2,title:"Propuesta de Valor",description:"Valor, diferenciación y beneficios"},{id:3,title:"Equipo de Trabajo",description:"Talento humano"},{id:4,title:"Canales de Comunicación",description:"Redes, ferias, contacto"},{id:5,title:"Canales de Comercialización",description:"Venta y distribución"},{id:6,title:"Socios Clave",description:"Aliados estrategicos"},{id:7,title:"Segmentos de Clientes",description:"Mercado objetivo"},{id:8,title:"Cadena de Suministro",description:"Flujo logístico"},{id:9,title:"Presupuestos / Parámetros Financieros",description:"Cálculos base"},{id:10,title:"Demanda",description:"Ventas proyectadas"},{id:11,title:"Equipos y Maquinaria",description:"Inversión en activos"},{id:12,title:"Costos Unitarios",description:"Producción por producto"},{id:13,title:"Provisiones y Gastos",description:"Gastos operativos"},{id:14,title:"Financiamiento",description:"Fuentes de inversión"},{id:15,title:"Anexos",description:"Evidencias y fotografías"}],Se=({entrepreneurshipId:P})=>{const[c,v]=i.useState(1),[A,y]=i.useState(!1),[L,b]=i.useState(!1),[S,h]=i.useState({isOpen:!1,title:"",message:""}),[j,Q]=i.useState(null),W=(t,a)=>h({isOpen:!0,title:t,message:a}),z=t=>navigator.onLine?t.message?.includes("Failed to fetch")||t.message?.includes("NetworkError")?"Error de conexión: No se pudo establecer comunicación con el servidor. Verifique su red.":t.message?.includes("subir")||t.message?.includes("upload")?"Fallo al procesar imágenes: No se pudieron cargar los archivos. Asegúrese de que el formato sea válido y que los archivos no sean demasiado pesados.":t.message?.includes("link")||t.message?.includes("vincular")||t.status===500?`No se pudo guardar el plan.

Ocurrió un problema interno al vincular el plan con el emprendimiento. Este error no está relacionado con los datos ingresados por usted.

Por favor, intente nuevamente en unos momentos. Si el problema persiste, contacte al administrador del sistema.`:`Datos Inconsistentes o Incompletos: Aunque todos los campos visibles pueden parecer correctos, existen datos inconsistentes en secciones como 'Provisiones', 'Anexos' o 'Cadena de Suministro' que impiden el procesamiento.

Por favor, revise las secciones anteriores para asegurar que toda la información esté correctamente ingresada.`:"Error de conexión: Verifique su acceso a Internet e intente nuevamente.",I=()=>{const t=[];let a=0;return(!p.businessDescription.trim()||!p.mainActivity.trim())&&(t.push("Descripción de negocio o actividad principal faltante (Paso 1)"),a===0&&(a=1)),p.supplyChainMode==="IMAGE"&&!oe&&!f.imageUrl&&(t.push("Falta cargar el diagrama de la cadena de suministro (Paso 8)"),a===0&&(a=8)),(N.length===0||N.every(s=>!s.productName.trim()))&&(t.push("Debe definir al menos un producto o servicio válido (Paso 12)"),a===0&&(a=12)),{isValid:t.length===0,messages:t,firstStep:a}},[p,ge]=i.useState({businessDescription:"",mainActivity:"",valueProposition:"",communicationChannels:"",commercializationChannels:"",supplyChainMode:"GUIDED"}),[le,ue]=i.useState([]),[D,_]=i.useState([{id:Date.now(),name:"",experience:"",role:""}]),[G,ne]=i.useState([{id:Date.now(),name:"",type:"PROVEEDOR"}]),[F,R]=i.useState([{id:Date.now(),name:"",percentage:"",ageRange:"",socioeconomicLevel:"C",characteristics:""}]),[f,H]=i.useState({providers:"",production:"",storage:"",distribution:"",client:"",imageUrl:""}),[oe,me]=i.useState(null),[xe,he]=i.useState(null),[l,C]=i.useState({prodPrev:"0",prodCurr:"0",pricePrev:"0",priceCurr:"0",riskFree:"0.00",riskCountry:"0.00",riskEnt:"0.00",inflationPrev:"0",inflationCurr:"0",salaryPrev:"0",salaryCurr:"0"}),[M,Y]=i.useState([{id:Date.now(),productName:"",monthlyDemand:"",unitPrice:""}]),[k,T]=i.useState([{id:Date.now(),description:"",quantity:1,unitPrice:"",accountType:"Activo Fijo",financingSource:"Propio"}]),[N,J]=i.useState([{id:Date.now(),productName:"",monthlyQuantity:"",unitCost:""}]),[m,E]=i.useState({}),[U,K]=i.useState([{id:Date.now(),concept:"Inversión Inicial",amount:"",source:"Propia"}]),[ie,ve]=i.useState({investment:0,monthlyRevenue:0,monthlyCosts:0}),g=i.useMemo(()=>{const t=(o,w)=>{const $=parseFloat(o),Z=parseFloat(w);if(isNaN($)||isNaN(Z))return 0;const re=Math.abs($-Z),ee=Math.min($,Z);return ee===0?0:re/ee},a=N.map(o=>{const w=parseFloat(o.monthlyQuantity.toString())||0,$=parseFloat(o.unitCost.toString())||0;return{...o,total:w*$}}),s=a.reduce((o,w)=>o+w.total,0),r=s*12,u=a.map((o,w)=>{const Z=(m[o.id.toString()]||[]).map(te=>{const ce=parseFloat(te.monthlyQuantity)||0,ke=parseFloat(te.unitPrice)||0;return{...te,total:ce*ke}}),re=Z.reduce((te,ce)=>te+ce.total,0),ee=parseFloat(o.monthlyQuantity.toString())||0,Ce=ee>0?re/ee:0;return{productId:o.id,productName:o.productName||`Producto ${w+1} `,originalIndex:w,inputs:Z,costoTotalProduct:re,costoUnitarioProduct:Ce}}),x=u.reduce((o,w)=>o+w.costoTotalProduct,0);return{growthRate:t(l.prodCurr,l.prodPrev),priceGrowthRate:t(l.priceCurr,l.pricePrev),discountRate:parseFloat(l.riskFree)+parseFloat(l.riskCountry)+parseFloat(l.riskEnt),inflationRate:t(l.inflationCurr,l.inflationPrev),salaryIncreaseRate:t(l.salaryCurr,l.salaryPrev),unitCostList:a,totalMonthlyUnitCost:s,totalAnnualUnitCost:r,productProvisions:u,totalGeneralProvisions:x}},[l,N,m]),O=t=>"$ "+t.toLocaleString("es-EC",{minimumFractionDigits:2,maximumFractionDigits:2}),be=t=>(t*100).toFixed(2).replace(".",",")+" %",X=({label:t,value:a})=>e.jsxs("div",{className:"mt-8 -mx-6 -mb-6 bg-[#FAFAFA] border-t border-slate-100 px-6 py-5 flex flex-col sm:flex-row justify-between items-center gap-4 transition-all duration-300 rounded-b-[20px]",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-xl bg-white shadow-sm border border-slate-100 text-indigo-600 transition-transform group-hover:scale-110",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-[10px] font-black text-indigo-500 uppercase tracking-[0.2em] leading-none mb-1.5 font-sans",children:"Resultado de Proyección"}),e.jsx("p",{className:"text-[11px] font-bold text-slate-500 uppercase tracking-wide max-w-[200px] leading-tight",children:t})]})]}),e.jsxs("div",{className:"flex items-center gap-4 bg-white px-5 py-3 rounded-[20px] border border-slate-100 shadow-sm hover:border-indigo-300 transition-all group",children:[e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-tighter mb-0.5",children:"Indicador Calculado"}),e.jsx("span",{className:"text-2xl font-black text-indigo-600 font-mono tracking-tighter leading-none",children:be(a)})]}),e.jsx("div",{className:"pl-4 border-l border-slate-100 text-slate-300 group-hover:text-indigo-400 transition-colors",title:"Valor calculado automáticamente por el sistema",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})})]})]});i.useEffect(()=>{const t=k.reduce((s,r)=>s+(parseFloat(r.unitPrice.toString())||0)*(r.quantity||1),0),a=M.reduce((s,r)=>s+(parseFloat(r.unitPrice.toString())||0)*(parseFloat(r.monthlyDemand.toString())||0),0);ve(s=>({...s,investment:t,monthlyRevenue:a}))},[k,M]);const d=(t,a,s,r,u)=>{const x=[...u];x[t]={...x[t],[a]:s},r(x)},B=(t,a)=>{ge(s=>({...s,[t]:a}))},V=(t,a,s)=>t([...a,{id:Date.now(),...s}]),q=(t,a,s)=>{s.length>1&&a(s.filter((r,u)=>u!==t))},pe=t=>{if(t.target.files&&t.target.files[0]){const a=t.target.files[0];me(a),he(URL.createObjectURL(a))}},je=()=>{me(null),he(null),H(t=>({...t,imageUrl:""}))},fe=t=>{if(t.target.files){const s=Array.from(t.target.files).map(r=>({id:Math.random().toString(36).substr(2,9),file:r,preview:URL.createObjectURL(r)}));ue(r=>[...r,...s])}},Ne=t=>{ue(a=>{const s=a.find(r=>r.id===t);return s&&URL.revokeObjectURL(s.preview),a.filter(r=>r.id!==t)})},we=async()=>{if(!P){W("Error de Configuración","No se ha seleccionado un emprendimiento válido.");return}const t=I();if(!t.isValid){h({isOpen:!0,title:"Información Obligatoria Faltante",message:`Para poder guardar el plan, debe corregir lo siguiente:

• ${t.messages.join(`
• `)}`}),v(t.firstStep);return}y(!0);try{let a=f.imageUrl;if(oe)try{a=(await ae.uploadImage("/upload/image",oe,{type:"supply-chain"})).url}catch(r){throw console.error("Error uploading sc image",r),new Error("No se pudo subir la imagen de la cadena de suministro.")}const s=[];for(const r of le)try{const u=await ae.uploadImage("/upload/image",r.file,{type:"annex"});s.push(u.url)}catch(u){throw console.error("Error uploading annex",u),new Error("Error al subir uno de los anexas.")}await ae.createPlan({entrepreneurshipId:P,...p,team:D,partners:G,segments:F,supplyChain:{...f,imageUrl:a},annexes:s,rates:g,demands:M,equipments:k,unitCosts:g.unitCostList,totalCost:ie.investment,totalMonthlyUnitCost:g.totalMonthlyUnitCost,totalAnnualUnitCost:g.totalAnnualUnitCost,provisions:g.productProvisions,totalGeneralProvisions:g.totalGeneralProvisions,financing:U}),window.location.href="/dashboard"}catch(a){console.error("Submission error:",a),W("Error al Guardar",z(a))}finally{y(!1)}},ye=()=>{switch(c){case 1:return e.jsxs("div",{className:"space-y-6",children:[e.jsx(n,{label:"Descripción general del negocio",isTextArea:!0,value:p.businessDescription,onChange:t=>B("businessDescription",t.target.value)}),e.jsx(n,{label:"Actividad principal",isTextArea:!0,value:p.mainActivity,onChange:t=>B("mainActivity",t.target.value)})]});case 2:return e.jsx("div",{className:"space-y-6",children:e.jsx(n,{label:"Propuesta de valor principal",isTextArea:!0,value:p.valueProposition,onChange:t=>B("valueProposition",t.target.value)})});case 3:return e.jsx("div",{className:"space-y-8",children:e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-800 mb-4",children:"Integrantes del Equipo"}),D.map((t,a)=>e.jsxs("div",{className:"grid grid-cols-12 gap-4 mb-4 bg-[#FAFAFA] p-4 rounded-lg border",children:[e.jsx("div",{className:"col-span-4",children:e.jsx(n,{label:"Nombre",value:t.name,onChange:s=>d(a,"name",s.target.value,_,D)})}),e.jsx("div",{className:"col-span-4",children:e.jsx(n,{label:"Rol",value:t.role,onChange:s=>d(a,"role",s.target.value,_,D)})}),e.jsx("div",{className:"col-span-3",children:e.jsx(n,{label:"Experiencia",value:t.experience,onChange:s=>d(a,"experience",s.target.value,_,D)})}),e.jsxs("div",{className:"col-span-1 border-l flex flex-col items-center justify-center group/delete",children:[e.jsx("span",{className:"text-[8px] font-black text-slate-400 uppercase tracking-[0.2em] mb-1 group-hover/delete:text-red-500 transition-colors duration-300",children:"Quitar"}),e.jsx("button",{onClick:()=>q(a,_,D),className:"w-9 h-9 flex items-center justify-center rounded-xl text-slate-400 hover:bg-red-500 hover:text-white hover:border-red-500 transition-all duration-300 border bg-white shadow-sm hover:shadow-red-200 hover:shadow-lg active:scale-90",title:"Quitar elemento",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},t.id)),e.jsx("button",{onClick:()=>V(_,D,{name:"",experience:"",role:""}),className:"text-primary-600 font-bold",children:"+ Agregar Integrante"})]})});case 4:return e.jsx("div",{className:"space-y-6",children:e.jsx(n,{label:"Canales de Comunicación (Ej: Redes Sociales, Ferias, Contacto Directo)",isTextArea:!0,value:p.communicationChannels,onChange:t=>B("communicationChannels",t.target.value)})});case 5:return e.jsx("div",{className:"space-y-6",children:e.jsx(n,{label:"Canales de Comercialización (Ej: Venta Directa, Distribuidores, Online)",isTextArea:!0,value:p.commercializationChannels,onChange:t=>B("commercializationChannels",t.target.value)})});case 6:return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"font-bold text-slate-800 mb-4",children:"Socios Clave"}),G.map((t,a)=>e.jsxs("div",{className:"grid grid-cols-12 gap-4 mb-4 bg-[#FAFAFA] p-4 rounded-lg border",children:[e.jsx("div",{className:"col-span-6",children:e.jsx(n,{label:"Nombre",value:t.name,onChange:s=>d(a,"name",s.target.value,ne,G)})}),e.jsx("div",{className:"col-span-5",children:e.jsx(n,{label:"Tipo",select:!0,options:[{label:"Proveedor",value:"PROVEEDOR"},{label:"Institución",value:"INSTITUCION"},{label:"Aliado",value:"ALIADO"}],value:t.type,onChange:s=>d(a,"type",s.target.value,ne,G)})}),e.jsxs("div",{className:"col-span-1 border-l flex flex-col items-center justify-center group/delete",children:[e.jsx("span",{className:"text-[8px] font-black text-slate-400 uppercase tracking-[0.2em] mb-1 group-hover/delete:text-red-500 transition-colors duration-300",children:"Quitar"}),e.jsx("button",{onClick:()=>q(a,ne,G),className:"w-9 h-9 flex items-center justify-center rounded-xl text-slate-400 hover:bg-red-500 hover:text-white hover:border-red-500 transition-all duration-300 border bg-white shadow-sm hover:shadow-red-200 hover:shadow-lg active:scale-90",title:"Quitar elemento",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},t.id)),e.jsx("button",{onClick:()=>V(ne,G,{name:"",type:"PROVEEDOR"}),className:"text-primary-600 font-bold",children:"+ Agregar Socio"})]});case 7:return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"font-bold text-slate-800 mb-4",children:"Segmentos de Clientes"}),F.map((t,a)=>e.jsxs("div",{className:"bg-[#FAFAFA] p-4 rounded-lg mb-4 border",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-2",children:[e.jsx(n,{label:"Nombre del segmento",value:t.name,onChange:s=>d(a,"name",s.target.value,R,F)}),e.jsx(n,{label:"Porcentaje (%)",type:"number",value:t.percentage,onChange:s=>d(a,"percentage",s.target.value,R,F)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-2",children:[e.jsx(n,{label:"Rango de Edad",value:t.ageRange,onChange:s=>d(a,"ageRange",s.target.value,R,F)}),e.jsx(n,{label:"Nivel Socioeconómico",select:!0,options:[{label:"A",value:"A"},{label:"B",value:"B"},{label:"C+",value:"C+"},{label:"C-",value:"C-"}],value:t.socioeconomicLevel,onChange:s=>d(a,"socioeconomicLevel",s.target.value,R,F)})]}),e.jsx(n,{label:"Características",isTextArea:!0,value:t.characteristics,onChange:s=>d(a,"characteristics",s.target.value,R,F)}),e.jsxs("div",{className:"flex flex-col items-end group/delete mt-2",children:[e.jsx("span",{className:"text-[8px] font-black text-slate-400 uppercase tracking-[0.2em] mb-1 group-hover/delete:text-red-500 transition-colors duration-300",children:"Quitar"}),e.jsx("button",{onClick:()=>q(a,R,F),className:"w-9 h-9 flex items-center justify-center rounded-xl text-slate-400 hover:bg-red-500 hover:text-white hover:border-red-500 transition-all duration-300 border bg-white shadow-sm hover:shadow-red-200 hover:shadow-lg active:scale-90",title:"Quitar elemento",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},t.id)),e.jsx("button",{onClick:()=>V(R,F,{name:"",percentage:"",ageRange:"",socioeconomicLevel:"C",characteristics:""}),className:"text-primary-600 font-bold",children:"+ Agregar Segmento"})]});case 8:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 p-1.5 bg-slate-100/50 border rounded-[20px] mb-8",children:[e.jsxs("button",{onClick:()=>B("supplyChainMode","GUIDED"),className:`flex flex-col items-center justify-center py-4 px-6 rounded-[20px] transition-all duration-300 ${p.supplyChainMode==="GUIDED"?"bg-white text-indigo-600 border shadow-xl translate-y-[-2px]":"text-slate-500 hover:bg-white/50 hover:text-slate-700"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-full mb-2 flex items-center justify-center transition-colors ${p.supplyChainMode==="GUIDED"?"bg-indigo-600 text-white":"bg-slate-200 text-slate-500"}`,children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("span",{className:"text-sm font-black uppercase tracking-widest",children:"Modo Guiado"}),e.jsx("span",{className:"text-[10px] opacity-60 font-bold mt-0.5",children:"Descripción por pasos"})]}),e.jsxs("button",{onClick:()=>B("supplyChainMode","IMAGE"),className:`flex flex-col items-center justify-center py-4 px-6 rounded-[20px] transition-all duration-300 ${p.supplyChainMode==="IMAGE"?"bg-white text-indigo-600 border shadow-xl translate-y-[-2px]":"text-slate-500 hover:bg-white/50 hover:text-slate-700"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-full mb-2 flex items-center justify-center transition-colors ${p.supplyChainMode==="IMAGE"?"bg-indigo-600 text-white":"bg-slate-200 text-slate-500"}`,children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("span",{className:"text-sm font-black uppercase tracking-widest",children:"Diagrama"}),e.jsx("span",{className:"text-[10px] opacity-60 font-bold mt-0.5",children:"Captura / Imagen"})]})]}),p.supplyChainMode==="GUIDED"?e.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-bottom-2",children:[e.jsx(n,{label:"Proveedores",value:f.providers,onChange:t=>H({...f,providers:t.target.value})}),e.jsx(n,{label:"Producción",value:f.production,onChange:t=>H({...f,production:t.target.value})}),e.jsx(n,{label:"Almacenamiento",value:f.storage,onChange:t=>H({...f,storage:t.target.value})}),e.jsx(n,{label:"Distribución",value:f.distribution,onChange:t=>H({...f,distribution:t.target.value})}),e.jsx(n,{label:"Cliente final",value:f.client,onChange:t=>H({...f,client:t.target.value})})]}):e.jsx("div",{className:"space-y-4 animate-in fade-in slide-in-from-bottom-2",children:e.jsx("div",{className:"p-8 border-2 border-dashed border-slate-200 rounded-[20px] flex flex-col items-center justify-center bg-[#FAFAFA] hover:bg-slate-100 transition-colors",children:xe?e.jsxs("div",{className:"text-center w-full",children:[e.jsx("img",{src:xe,alt:"Diagrama Preview",className:"h-48 mx-auto object-contain mb-4 bg-white p-2 rounded shadow-sm"}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsxs("label",{className:"btn btn-sm btn-outline cursor-pointer bg-white",children:["Cambiar Imagen",e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:pe})]}),e.jsxs("div",{className:"flex flex-col items-center group/delete",children:[e.jsx("span",{className:"text-[8px] font-black text-slate-400 uppercase tracking-[0.2em] mb-1 group-hover/delete:text-red-500 transition-colors duration-300",children:"Quitar"}),e.jsx("button",{onClick:je,className:"w-9 h-9 flex items-center justify-center rounded-xl text-slate-400 hover:bg-red-500 hover:text-white hover:border-red-500 transition-all duration-300 border bg-white shadow-sm hover:shadow-red-200 hover:shadow-lg active:scale-90",title:"Quitar elemento",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})]}):e.jsxs("label",{className:"cursor-pointer text-center w-full py-8",children:[e.jsx("div",{className:"bg-white p-4 rounded-full shadow-sm inline-block mb-3",children:e.jsx("svg",{className:"w-8 h-8 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("div",{className:"font-bold text-slate-700",children:"Subir Diagrama"}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:pe})]})})})]});case 9:return e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"bg-blue-50 p-4 rounded-xl border border-blue-100 mb-6",children:e.jsxs("p",{className:"text-sm text-blue-700",children:[e.jsx("b",{children:"Nota:"})," Ingrese los valores base. El sistema calculará automáticamente los porcentajes financieros para las proyecciones."]})}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("h4",{className:"font-bold text-slate-800 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"p-1.5 bg-indigo-100 text-indigo-600 rounded",children:"01"}),"Crecimiento de la Producción"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(n,{label:"Producción año anterior (unidades)",type:"number",value:l.prodPrev,onChange:t=>C({...l,prodPrev:t.target.value})}),e.jsx(n,{label:"Producción año actual (unidades)",type:"number",value:l.prodCurr,onChange:t=>C({...l,prodCurr:t.target.value})})]}),e.jsx(X,{label:"Tasa de crecimiento de la producción",value:g.growthRate})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("h4",{className:"font-bold text-slate-800 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"p-1.5 bg-indigo-100 text-indigo-600 rounded",children:"02"}),"Crecimiento del Precio (PVP)"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(n,{label:"Precio anterior (USD)",type:"number",value:l.pricePrev,onChange:t=>C({...l,pricePrev:t.target.value})}),e.jsx(n,{label:"Precio actual (USD)",type:"number",value:l.priceCurr,onChange:t=>C({...l,priceCurr:t.target.value})})]}),e.jsx(X,{label:"Tasa de crecimiento del precio de venta al público",value:g.priceGrowthRate})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("h4",{className:"font-bold text-slate-800 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"p-1.5 bg-indigo-100 text-indigo-600 rounded",children:"03"}),"Parámetros para Tasa de Descuento"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(de,{label:"Tasa libre de riesgo",value:l.riskFree,onChange:t=>C({...l,riskFree:t.target.value}),options:[{label:"Seleccione una opción...",value:"0.00"},{label:"Bono del Estado (académica) - 4%",value:"0.04",recommended:!0},{label:"Depósito a plazo fijo - 3%",value:"0.03"},{label:"Otro valor - 0%",value:"0.00"}]}),e.jsx(de,{label:"Prima riesgo país",value:l.riskCountry,onChange:t=>C({...l,riskCountry:t.target.value}),options:[{label:"Seleccione nivel...",value:"0.00"},{label:"Bajo - 3%",value:"0.03"},{label:"Medio - 4.6% (Ecuador, EMBI)",value:"0.04",recommended:!0},{label:"Alto - 6%",value:"0.06"}]}),e.jsx(de,{label:"Riesgo de emprendimiento",value:l.riskEnt,onChange:t=>C({...l,riskEnt:t.target.value}),options:[{label:"Seleccione condición...",value:"0.00"},{label:"Negocio nuevo - 8%",value:"0.08",recommended:!0},{label:"En crecimiento - 5%",value:"0.0493"},{label:"Consolidado - 3%",value:"0.03"}]})]}),e.jsx(X,{label:"Tasa de descuento",value:g.discountRate})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("h4",{className:"font-bold text-slate-800 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"p-1.5 bg-indigo-100 text-indigo-600 rounded",children:"04"}),"Tasa de Inflación"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(n,{label:"Índice precios año anterior",type:"number",value:l.inflationPrev,onChange:t=>C({...l,inflationPrev:t.target.value})}),e.jsx(n,{label:"Índice precios año actual",type:"number",value:l.inflationCurr,onChange:t=>C({...l,inflationCurr:t.target.value})})]}),e.jsx(X,{label:"Tasa de inflación",value:g.inflationRate})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("h4",{className:"font-bold text-slate-800 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"p-1.5 bg-indigo-100 text-indigo-600 rounded",children:"05"}),"Incremento de Sueldos y Salarios"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(n,{label:"Sueldo anterior (USD)",type:"number",value:l.salaryPrev,onChange:t=>C({...l,salaryPrev:t.target.value})}),e.jsx(n,{label:"Sueldo actual (USD)",type:"number",value:l.salaryCurr,onChange:t=>C({...l,salaryCurr:t.target.value})})]}),e.jsx(X,{label:"Tasa de incremento de sueldo y salarios",value:g.salaryIncreaseRate})]})]});case 10:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center bg-slate-900 text-white p-4 rounded-xl",children:[e.jsx("span",{className:"font-bold",children:"Ingresos Mensuales Estimados"}),e.jsxs("span",{className:"text-xl font-mono text-green-400",children:["$",ie.monthlyRevenue.toFixed(2)]})]}),M.map((t,a)=>e.jsxs("div",{className:"grid grid-cols-12 gap-4 bg-[#FAFAFA] p-4 rounded-lg items-end border mb-4",children:[e.jsx("div",{className:"col-span-6",children:e.jsx(n,{label:"Producto",value:t.productName,onChange:s=>d(a,"productName",s.target.value,Y,M)})}),e.jsx("div",{className:"col-span-2",children:e.jsx(n,{label:"Demanda Mes",type:"number",value:t.monthlyDemand,onChange:s=>d(a,"monthlyDemand",s.target.value,Y,M)})}),e.jsx("div",{className:"col-span-3",children:e.jsx(n,{label:"Precio Unitario",type:"number",value:t.unitPrice,onChange:s=>d(a,"unitPrice",s.target.value,Y,M)})}),e.jsxs("div",{className:"col-span-1 border-l flex flex-col items-center justify-center group/delete",children:[e.jsx("span",{className:"text-[8px] font-black text-slate-400 uppercase tracking-[0.2em] mb-1 group-hover/delete:text-red-500 transition-colors duration-300",children:"Quitar"}),e.jsx("button",{onClick:()=>q(a,Y,M),className:"w-9 h-9 flex items-center justify-center rounded-xl text-slate-400 hover:bg-red-500 hover:text-white hover:border-red-500 transition-all duration-300 border bg-white shadow-sm hover:shadow-red-200 hover:shadow-lg active:scale-90",title:"Quitar elemento",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},t.id)),e.jsx("button",{onClick:()=>V(Y,M,{productName:"",monthlyDemand:"",unitPrice:""}),className:"font-bold text-primary-600",children:"+ Agregar Producto"})]});case 11:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center bg-slate-900 text-white p-4 rounded-xl",children:[e.jsx("span",{className:"font-bold",children:"Inversión Inicial en Equipos"}),e.jsxs("span",{className:"text-xl font-mono text-blue-400",children:["$",ie.investment.toFixed(2)]})]}),k.map((t,a)=>e.jsxs("div",{className:"bg-[#FAFAFA] p-4 rounded-lg space-y-4 border mb-4",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-4 items-end",children:[e.jsx("div",{className:"col-span-5",children:e.jsx(n,{label:"Descripción",value:t.description,onChange:s=>d(a,"description",s.target.value,T,k)})}),e.jsx("div",{className:"col-span-2",children:e.jsx(n,{label:"Cantidad",type:"number",value:t.quantity,onChange:s=>d(a,"quantity",parseInt(s.target.value),T,k)})}),e.jsx("div",{className:"col-span-4",children:e.jsx(n,{label:"Precio Unitario",type:"number",value:t.unitPrice,onChange:s=>d(a,"unitPrice",s.target.value,T,k)})}),e.jsxs("div",{className:"col-span-1 border-l flex flex-col items-center justify-center group/delete",children:[e.jsx("span",{className:"text-[8px] font-black text-slate-400 uppercase tracking-[0.2em] mb-1 group-hover/delete:text-red-500 transition-colors duration-300",children:"Quitar"}),e.jsx("button",{onClick:()=>q(a,T,k),className:"w-9 h-9 flex items-center justify-center rounded-xl text-slate-400 hover:bg-red-500 hover:text-white hover:border-red-500 transition-all duration-300 border bg-white shadow-sm hover:shadow-red-200 hover:shadow-lg active:scale-90",title:"Quitar elemento",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 border-t pt-4",children:[e.jsx(n,{label:"Tipo de Cuenta",select:!0,options:[{label:"Maquinaria y Equipos",value:"Maquinaria y Equipos"},{label:"Muebles y Enseres",value:"Muebles y Enseres"},{label:"Software",value:"Software"},{label:"Otros",value:"Otros"}],value:t.accountType,onChange:s=>d(a,"accountType",s.target.value,T,k)}),e.jsx(n,{label:"Financiamiento",select:!0,options:[{label:"Propio",value:"Propio"},{label:"Préstamo",value:"Prestamo"},{label:"Donación",value:"Donacion"}],value:t.financingSource,onChange:s=>d(a,"financingSource",s.target.value,T,k)})]})]},t.id)),e.jsx("button",{onClick:()=>V(T,k,{description:"",quantity:1,unitPrice:"",accountType:"Maquinaria y Equipos",financingSource:"Propio"}),className:"font-bold text-primary-600",children:"+ Agregar Activo"})]});case 12:return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex justify-between items-center pb-2 border-b border-slate-100",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-800 text-lg",children:"Costos Unitarios de Producción"}),e.jsx("p",{className:"text-xs text-slate-400 mt-0.5",children:"Define los costos operativos directos por cada producto o servicio."})]}),e.jsxs("div",{className:"text-[10px] font-black text-slate-400 bg-[#FAFAFA] px-3 py-1.5 rounded-lg border border-slate-100 uppercase tracking-widest",children:[N.length," ",N.length===1?"Producto":"Productos"]})]}),e.jsx("div",{className:"space-y-2",children:g.unitCostList.map((t,a)=>e.jsx("div",{className:"group relative bg-white hover:bg-[#FAFAFA]/50 p-4 rounded-xl border border-transparent hover:border-slate-100 transition-all",children:e.jsxs("div",{className:"grid grid-cols-12 gap-6 items-center",children:[e.jsx("div",{className:"col-span-12 md:col-span-5",children:e.jsx(n,{label:"Producto o Servicio",value:t.productName,onChange:s=>d(a,"productName",s.target.value,J,N)})}),e.jsx("div",{className:"col-span-5 md:col-span-2",children:e.jsx(n,{label:"Cant. Mensual",type:"number",value:t.monthlyQuantity,onChange:s=>d(a,"monthlyQuantity",s.target.value,J,N)})}),e.jsx("div",{className:"col-span-5 md:col-span-2",children:e.jsx(n,{label:"Costo Unitario",type:"number",value:t.unitCost,onChange:s=>d(a,"unitCost",s.target.value,J,N)})}),e.jsxs("div",{className:"col-span-10 md:col-span-2 flex flex-col items-end justify-center pt-5",children:[e.jsx("span",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-widest mb-0.5",children:"Costo Total"}),e.jsx("span",{className:"text-sm font-bold text-indigo-600 font-mono",children:O(t.total)})]}),e.jsxs("div",{className:"col-span-2 md:col-span-1 border-l flex flex-col items-center justify-center group/delete",children:[e.jsx("span",{className:"text-[8px] font-black text-slate-400 uppercase tracking-[0.2em] mb-1 group-hover/delete:text-red-500 transition-colors duration-300",children:"Quitar"}),e.jsx("button",{onClick:()=>q(a,J,N),className:"w-9 h-9 flex items-center justify-center rounded-xl text-slate-400 hover:bg-red-500 hover:text-white hover:border-red-500 transition-all duration-300 border bg-white shadow-sm hover:shadow-red-200 hover:shadow-lg active:scale-90",title:"Quitar elemento",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},t.id))}),e.jsx("div",{className:"flex justify-center -mt-2",children:e.jsxs("button",{onClick:()=>V(J,N,{productName:"",monthlyQuantity:"",unitCost:""}),className:"flex items-center gap-2 px-5 py-2.5 text-xs font-bold text-indigo-600 hover:text-indigo-700 hover:bg-indigo-50 rounded-xl transition-all group",children:[e.jsx("div",{className:"w-5 h-5 flex items-center justify-center bg-indigo-50 text-indigo-600 rounded-lg group-hover:bg-indigo-100 transition-colors",children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),"Agregar Producto o Servicio"]})}),e.jsxs("div",{className:"mt-12 bg-[#FAFAFA] border border-slate-100 rounded-2xl p-6 md:p-8 flex flex-col md:flex-row justify-between items-center gap-10",children:[e.jsxs("div",{className:"space-y-1 text-center md:text-left",children:[e.jsxs("h4",{className:"font-bold text-slate-700 text-sm flex items-center justify-center md:justify-start gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-indigo-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),"Resumen de Costos Directos"]}),e.jsx("p",{className:"text-xs text-slate-400",children:"Totales proyectados basados en los insumos anteriores."})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-8 md:gap-12",children:[e.jsxs("div",{className:"text-center sm:text-right",children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"Total Mensual"}),e.jsx("p",{className:"text-lg font-bold text-slate-600 font-mono",children:O(g.totalMonthlyUnitCost)})]}),e.jsx("div",{className:"h-10 w-px bg-slate-200 hidden sm:block"}),e.jsxs("div",{className:"text-center sm:text-left relative",children:[e.jsx("div",{className:"absolute -top-6 left-1/2 -translate-x-1/2 sm:left-0 sm:translate-x-0",children:e.jsx("span",{className:"bg-emerald-100 text-emerald-700 text-[9px] font-bold px-2 py-0.5 rounded-full uppercase tracking-tighter border border-emerald-200",children:"Proyección Anual"})}),e.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-1",children:"Costo Total (12 Meses)"}),e.jsx("p",{className:"text-3xl font-black text-emerald-600 font-mono tracking-tighter",children:O(g.totalAnnualUnitCost)})]})]})]})]});case 13:return e.jsxs("div",{className:"space-y-10",children:[g.productProvisions.filter(t=>Object.prototype.hasOwnProperty.call(m,t.productId.toString())).map((t,a)=>e.jsxs("div",{className:"bg-white rounded-2xl border overflow-hidden shadow-sm hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"bg-slate-900 px-6 py-4 flex justify-between items-center",children:[e.jsxs("h4",{className:"text-white font-black text-sm uppercase tracking-widest flex items-center gap-2",children:[e.jsx("span",{className:"w-6 h-6 rounded-full bg-indigo-500 text-white flex items-center justify-center text-[10px]",children:t.originalIndex+1}),"PRODUCTO ",t.originalIndex+1,": ",t.productName]}),e.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-tighter",children:"Detalle de Insumos"})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-100",children:[e.jsx("th",{className:"pb-3 text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Insumos al mes del producto"}),e.jsx("th",{className:"pb-3 text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Unidad"}),e.jsx("th",{className:"pb-3 text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Cantidad"}),e.jsx("th",{className:"pb-3 text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Precio Unitario"}),e.jsx("th",{className:"pb-3 text-[10px] font-black text-slate-400 uppercase tracking-widest text-right",children:"Costo Total"}),e.jsx("th",{className:"pb-3"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50",children:(m[t.productId.toString()]||[]).length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:"py-8 text-center bg-[#FAFAFA] rounded-xl",children:[e.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:"No hay insumos agregados para este producto"}),e.jsx("button",{onClick:()=>{const s=t.productId.toString();E({...m,[s]:[{id:Date.now(),item:"",unit:"",monthlyQuantity:"0",unitPrice:"0"}]})},className:"mt-3 text-[10px] font-black text-indigo-500 hover:text-indigo-700 uppercase tracking-widest transition-colors",children:"+ Comenzar a agregar insumos"})]})}):t.inputs.map((s,r)=>e.jsxs("tr",{className:"group/row",children:[e.jsx("td",{className:"py-3 pr-4",children:e.jsx("input",{type:"text",value:s.item,onChange:u=>{const x=t.productId.toString(),o=[...m[x]||[]];o[r]={...o[r],item:u.target.value},E({...m,[x]:o})},className:"w-full px-3 py-2 bg-white border rounded-lg focus:ring-2 focus:ring-indigo-500/10 focus:border-indigo-400 outline-none text-sm font-semibold text-slate-700 placeholder:text-slate-300 transition-all hover:border-slate-300",placeholder:"Ingrese insumo..."})}),e.jsx("td",{className:"py-3 pr-4",children:e.jsx("input",{type:"text",value:s.unit,onChange:u=>{const x=t.productId.toString(),o=[...m[x]||[]];o[r]={...o[r],unit:u.target.value},E({...m,[x]:o})},className:"w-24 px-3 py-2 bg-white border rounded-lg focus:ring-2 focus:ring-indigo-500/10 focus:border-indigo-400 outline-none text-sm font-semibold text-slate-600 transition-all hover:border-slate-300",placeholder:"e.g. kg"})}),e.jsx("td",{className:"py-3 pr-4",children:e.jsx("input",{type:"number",value:s.monthlyQuantity,onChange:u=>{const x=t.productId.toString(),o=[...m[x]||[]];o[r]={...o[r],monthlyQuantity:u.target.value},E({...m,[x]:o})},className:"input-sm w-20 font-bold font-mono"})}),e.jsx("td",{className:"py-3 pr-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-xs",children:"$"}),e.jsx("input",{type:"number",value:s.unitPrice,onChange:u=>{const x=t.productId.toString(),o=[...m[x]||[]];o[r]={...o[r],unitPrice:u.target.value},E({...m,[x]:o})},className:"input-sm w-24 pl-6 pr-3 font-bold font-mono"})]})}),e.jsx("td",{className:"py-3 text-right",children:e.jsx("span",{className:"text-sm font-black text-indigo-600 font-mono",children:O(s.total)})}),e.jsx("td",{className:"py-3 pl-4 text-right",children:e.jsx("div",{className:"flex flex-col items-center group/delete",children:e.jsx("button",{onClick:()=>{const u=t.productId.toString(),x=(m[u]||[]).filter((o,w)=>w!==r);E({...m,[u]:x})},className:"w-7 h-7 flex items-center justify-center rounded-lg text-slate-300 hover:bg-red-500 hover:text-white transition-all active:scale-90",title:"Quitar insumo",children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})})]},s.id))})]})}),(m[t.productId.toString()]||[]).length>0&&e.jsxs("button",{onClick:()=>{const s=t.productId.toString(),r=m[s]||[];E({...m,[s]:[...r,{id:Date.now(),item:"",unit:"",monthlyQuantity:"0",unitPrice:"0"}]})},className:"mt-4 flex items-center gap-2 text-[10px] font-black text-indigo-500 uppercase tracking-widest hover:text-indigo-700 transition-colors",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3",d:"M12 4v16m8-8H4"})}),"Agregar Insumo"]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-slate-100 flex flex-col sm:flex-row justify-end items-center gap-8",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest mb-1",children:"Costo Total del Producto"}),e.jsx("p",{className:"text-lg font-black text-slate-900 font-mono leading-none",children:O(t.costoTotalProduct)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[9px] font-black text-indigo-400 uppercase tracking-widest mb-1",children:"Costo Unitario (Gastos)"}),e.jsx("p",{className:"text-lg font-black text-indigo-600 font-mono leading-none",children:O(t.costoUnitarioProduct).replace("$","$ ")})]})]})]})]},t.productId)),e.jsx("div",{className:"flex flex-col items-center gap-6 py-10 border-2 border-dashed border-slate-100 rounded-3xl bg-[#FAFAFA]/50",children:e.jsxs("button",{onClick:()=>{if(N.length===0){h({isOpen:!0,title:"Configuración Necesaria",message:"Primero debe definir los productos en la sección de Costos Unitarios para poder asignarles provisiones."});return}const t=N.find(a=>!Object.prototype.hasOwnProperty.call(m,a.id.toString()));t?E({...m,[t.id.toString()]:[]}):h({isOpen:!0,title:"Límite de Productos",message:`No hay más productos disponibles para agregar.

Si desea agregar un nuevo bloque de provisiones, primero debe definir el producto o servicio en la sección anterior (Paso 12: Costos Unitarios de Producción).`})},className:"group flex flex-col items-center gap-3 transition-all active:scale-95",children:[e.jsx("div",{className:"w-14 h-14 rounded-full bg-white border-2 border-indigo-500 flex items-center justify-center text-indigo-500 group-hover:bg-indigo-500 group-hover:text-white transition-all shadow-md",children:e.jsx("svg",{className:"w-7 h-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M12 4v16m8-8H4"})})}),e.jsx("span",{className:"text-[11px] font-black text-indigo-600 uppercase tracking-[0.2em]",children:"+ Agregar otro producto"})]})}),e.jsx("div",{className:"bg-[#FAFAFA] border border-slate-100 rounded-2xl p-6 shadow-sm",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"text-center md:text-left",children:[e.jsx("h4",{className:"text-slate-400 text-[10px] font-black uppercase tracking-[0.3em] mb-1",children:"Resumen Consolidado"}),e.jsx("p",{className:"text-slate-700 text-sm font-bold uppercase tracking-tight",children:"TOTAL GENERAL DE PROVISIONES DE GASTOS ADMINISTRATIVOS Y VENTAS"})]}),e.jsx("div",{className:"bg-white px-6 py-3 rounded-xl border shadow-sm",children:e.jsx("span",{className:"text-3xl font-black text-slate-900 font-mono",children:O(g.totalGeneralProvisions)})})]})})]});case 14:return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"font-bold text-slate-800 mb-4",children:"Estructura de Financiamiento"}),U.map((t,a)=>e.jsxs("div",{className:"grid grid-cols-12 gap-4 bg-[#FAFAFA] p-4 rounded-lg items-end mb-4 border border-slate-100",children:[e.jsx("div",{className:"col-span-5",children:e.jsx(n,{label:"Concepto",value:t.concept,onChange:s=>d(a,"concept",s.target.value,K,U)})}),e.jsx("div",{className:"col-span-3",children:e.jsx(n,{label:"Monto",type:"number",value:t.amount,onChange:s=>d(a,"amount",s.target.value,K,U)})}),e.jsx("div",{className:"col-span-3",children:e.jsx(n,{label:"Fuente",select:!0,options:[{label:"Propia",value:"Propia"},{label:"Préstamo",value:"Prestamo"},{label:"Donación",value:"Donacion"}],value:t.source,onChange:s=>d(a,"source",s.target.value,K,U)})}),e.jsxs("div",{className:"col-span-1 border-l flex flex-col items-center justify-center group/delete",children:[e.jsx("span",{className:"text-[8px] font-black text-slate-400 uppercase tracking-[0.2em] mb-1 group-hover/delete:text-red-500 transition-colors duration-300",children:"Quitar"}),e.jsx("button",{onClick:()=>q(a,K,U),className:"w-9 h-9 flex items-center justify-center rounded-xl text-slate-400 hover:bg-red-500 hover:text-white hover:border-red-500 transition-all duration-300 border bg-white shadow-sm hover:shadow-red-200 hover:shadow-lg active:scale-90",title:"Quitar elemento",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},t.id)),e.jsx("button",{onClick:()=>V(K,U,{concept:"",amount:"",source:"Propia"}),className:"font-bold text-primary-600",children:"+ Agregar Rubro"})]});case 15:return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"p-8 border-2 border-dashed border-slate-100 rounded-2xl flex flex-col items-center justify-center bg-[#FAFAFA] hover:bg-[#FAFAFA]/50 hover:border-indigo-300 transition-all group/annex",children:e.jsxs("label",{className:"cursor-pointer text-center w-full py-4",children:[e.jsx("div",{className:"bg-white p-6 rounded-full shadow-md inline-block mb-4 border border-slate-100 group-hover/annex:scale-110 group-hover/annex:text-indigo-600 transition-all",children:e.jsx("svg",{className:"w-10 h-10 text-primary-600 group-hover/annex:text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})})}),e.jsx("div",{className:"font-bold text-slate-700 text-lg",children:"Subir Imágenes de Evidencia"}),e.jsx("div",{className:"text-sm text-slate-500 mt-2",children:"Fotos, capturas o documentos gráficos"}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",multiple:!0,onChange:fe})]})}),le.length>0&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-6",children:le.map(t=>e.jsxs("div",{className:"relative group rounded-xl overflow-hidden border shadow-sm bg-white p-2",children:[e.jsx("img",{src:t.preview,alt:"Annex Preview",className:"h-24 w-full object-cover rounded-lg"}),e.jsxs("div",{className:"absolute top-1 right-1 flex flex-col items-center group/delete",children:[e.jsx("button",{onClick:()=>Ne(t.id),className:"w-9 h-9 flex items-center justify-center rounded-xl text-white bg-red-500 hover:bg-red-600 transition-all shadow-md active:scale-90",title:"Quitar elemento",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsx("span",{className:"text-[8px] font-black text-white/90 bg-red-500/80 px-1.5 py-0.5 rounded-full uppercase tracking-widest mt-1 opacity-0 group-hover/delete:opacity-100 transition-opacity",children:"Quitar"})]})]},t.id))}),e.jsxs("div",{className:"bg-indigo-900 text-white p-6 rounded-2xl mt-8",children:[e.jsx("h3",{className:"font-bold text-lg mb-2",children:"Finalizar Registro"}),e.jsx("p",{className:"text-sm opacity-80 leading-relaxed",children:"Al presionar el botón de abajo, se procesarán todos los cálculos financieros (VAN, TIR, Flujo de Caja) y se generará tu reporte completo."})]})]});default:return null}};return e.jsxs("div",{className:"flex flex-col space-y-8",children:[e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"flex justify-between items-center max-w-4xl mx-auto px-4 py-2 overflow-x-auto",children:se.map((t,a)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full border-2 font-bold transition-all ${c===t.id?"border-indigo-600 bg-indigo-600 text-white":c>t.id?"border-green-500 bg-green-500 text-white":"border-slate-300 text-slate-400"}`,onClick:()=>v(t.id),children:c>t.id?"✓":t.id}),e.jsx("span",{className:`ml-2 text-sm font-bold whitespace-nowrap hidden md:block ${c===t.id?"text-indigo-900":"text-slate-500"}`,children:t.title}),a<se.length-1&&e.jsx("div",{className:`w-12 h-0.5 mx-4 ${c>t.id?"bg-green-500":"bg-slate-300"}`})]},t.id))})}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"max-w-4xl mx-auto card overflow-hidden border-indigo-100/30",children:[e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-2xl font-black text-slate-900 tracking-tight mb-2",children:se[c-1].title}),e.jsx("p",{className:"text-slate-500 font-medium",children:se[c-1].description})]}),ye()]}),e.jsxs("div",{className:"px-8 py-6 bg-[#FAFAFA]/50 border-t border-slate-100 flex justify-between items-center",children:[e.jsx("button",{disabled:c===1,onClick:()=>v(t=>t-1),className:`btn btn-secondary ${c===1?"invisible":""}`,children:"Atrás"}),c<se.length?e.jsx("button",{onClick:()=>v(t=>t+1),className:"btn btn-primary px-10",children:"Siguiente"}):e.jsx("button",{onClick:we,disabled:A,className:"btn bg-green-600 hover:bg-green-700 text-white px-10 shadow-lg shadow-green-200",children:A?"Guardando...":"Finalizar y Guardar Plan"})]})]})}),e.jsx(Ae,{isOpen:S.isOpen,onClose:()=>h({...S,isOpen:!1}),title:S.title,message:S.message}),e.jsx(Pe,{isOpen:L,onClose:()=>{b(!1),Q(null)},onConfirm:()=>{j&&j.action(),b(!1),Q(null)},title:j?.title||"Confirmar Eliminación",message:j?.message||"¿Estás seguro de que quieres eliminar este elemento? Esta acción no se puede deshacer."})]})},Ie=()=>{const[P,c]=i.useState("SELECT"),[v,A]=i.useState([]),[y,L]=i.useState(null),[b,S]=i.useState(!0);return i.useEffect(()=>{(async()=>{try{const j=await ae.getEntrepreneurships(),Q=Array.isArray(j)?j:j.entrepreneurships||[];A(Q);const z=new URLSearchParams(window.location.search).get("entId");if(z){const I=parseInt(z);isNaN(I)||(L(I),c("WIZARD"))}}catch(j){console.error("Error loading entrepreneurships",j)}finally{S(!1)}})()},[]),b?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-indigo-500 border-t-transparent"}),e.jsx("p",{className:"mt-4 text-slate-500",children:"Cargando datos..."})]})}):P==="SELECT"?e.jsx("div",{className:"max-w-xl mx-auto pt-20 px-6",children:e.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-lg border border-slate-100 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-4",children:"Crear Nuevo Plan Económico"}),e.jsx("p",{className:"text-slate-500 mb-8",children:"Primero, selecciona el Emprendimiento al que pertenece este plan."}),v.length===0?e.jsxs("div",{className:"alert bg-yellow-50 border-yellow-200 text-yellow-800 p-4 rounded-lg",children:[e.jsx("div",{className:"font-bold mb-2",children:"No tienes emprendimientos registrados."}),e.jsx("div",{className:"text-sm mb-4",children:"Debes crear uno antes de hacer un plan económico."}),e.jsx("div",{className:"flex justify-center",children:e.jsx("a",{href:"/entrepreneurship/create",className:"btn btn-primary btn-sm inline-block shadow-md",children:"Crear Emprendimiento"})})]}):e.jsxs("div",{className:"space-y-4 text-left",children:[e.jsx("label",{className:"block font-medium text-slate-700",children:"Seleccionar Proyecto:"}),e.jsxs("select",{className:"select input w-full text-lg border-slate-300",onChange:h=>L(parseInt(h.target.value)),defaultValue:"",children:[e.jsx("option",{value:"",disabled:!0,children:"-- Elige un proyecto --"}),v.map(h=>e.jsxs("option",{value:h.id,children:[h.name," (",h.sector,")"]},h.id))]}),e.jsx("button",{className:`btn btn-primary btn-sm w-full mt-4 ${y?"":"opacity-50 cursor-not-allowed"}`,disabled:!y,onClick:()=>c("WIZARD"),children:"Continuar al Plan Financiero"})]})]})}):e.jsx(Se,{entrepreneurshipId:y})};export{Ie as PlanCreationContainer};
