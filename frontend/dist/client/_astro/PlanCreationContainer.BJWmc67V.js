import{j as e,I as n}from"./InputField.CDFBDmbB.js";import{r as i}from"./index.B52nOzfP.js";import{a as B}from"./api.DUBSwrnZ.js";const q=[{id:1,title:"Descripción del Negocio",description:"Resumen, actividad y enfoque"},{id:2,title:"Propuesta de Valor",description:"Valor, diferenciación y beneficios"},{id:3,title:"Equipo de Trabajo",description:"Talento humano"},{id:4,title:"Canales de Comunicación",description:"Redes, ferias, contacto"},{id:5,title:"Canales de Comercialización",description:"Venta y distribución"},{id:6,title:"Socios Clave",description:"Aliados estrategicos"},{id:7,title:"Segmentos de Clientes",description:"Mercado objetivo"},{id:8,title:"Cadena de Suministro",description:"Flujo logístico"},{id:9,title:"Tasas y Supuestos",description:"Parámetros financieros"},{id:10,title:"Demanda",description:"Ventas proyectadas"},{id:11,title:"Equipos y Maquinaria",description:"Inversión en activos"},{id:12,title:"Costos Unitarios",description:"Producción por producto"},{id:13,title:"Provisiones y Gastos",description:"Gastos operativos"},{id:14,title:"Financiamiento",description:"Fuentes de inversión"},{id:15,title:"Anexos",description:"Evidencias y fotografías"}],te=({entrepreneurshipId:G})=>{const[d,D]=i.useState(1),[O,E]=i.useState(!1),[o,V]=i.useState({businessDescription:"",mainActivity:"",productiveFocus:"",valueProposition:"",differentiation:"",customerBenefits:"",communicationChannels:"",commercializationChannels:"",supplyChainMode:"GUIDED"}),[F,g]=i.useState([]),[u,w]=i.useState([{id:Date.now(),name:"",experience:"",role:""}]),[f,N]=i.useState([{id:Date.now(),name:"",type:"PROVEEDOR",role:""}]),[m,P]=i.useState([{id:Date.now(),name:"",percentage:"",ageRange:"",socioeconomicLevel:"C",characteristics:""}]),[p,k]=i.useState({providers:"",production:"",storage:"",distribution:"",client:"",imageUrl:""}),[z,$]=i.useState(null),[W,H]=i.useState(null),[c,T]=i.useState({growthRate:"5",priceGrowthRate:"3",discountRate:"12",inflationRate:"4",salaryIncreaseRate:"5"}),[j,L]=i.useState([{id:Date.now(),productName:"",monthlyDemand:"",unitPrice:""}]),[x,S]=i.useState([{id:Date.now(),description:"",quantity:1,unitPrice:"",accountType:"Activo Fijo",financingSource:"Propio"}]),[I,M]=i.useState([{id:Date.now(),productName:"",monthlyQuantity:"",unitCost:""}]),[b,A]=i.useState([{id:Date.now(),item:"",unit:"",monthlyQuantity:"",unitPrice:""}]),[R,U]=i.useState([{id:Date.now(),concept:"Inversión Inicial",amount:"",source:"Propia"}]),[Z,J]=i.useState({investment:0,monthlyRevenue:0,monthlyCosts:0});i.useEffect(()=>{const a=x.reduce((r,h)=>r+(parseFloat(h.unitPrice.toString())||0)*(h.quantity||1),0),s=j.reduce((r,h)=>r+(parseFloat(h.unitPrice.toString())||0)*(parseFloat(h.monthlyDemand.toString())||0),0),t=b.reduce((r,h)=>r+(parseFloat(h.unitPrice.toString())||0)*(parseFloat(h.monthlyQuantity.toString())||0),0);J({investment:a,monthlyRevenue:s,monthlyCosts:t})},[x,j,b]);const l=(a,s,t,r,h)=>{const Q=[...h];Q[a]={...Q[a],[s]:t},r(Q)},v=(a,s)=>{V(t=>({...t,[a]:s}))},y=(a,s,t)=>a([...s,{id:Date.now(),...t}]),C=(a,s,t)=>{t.length>1&&s(t.filter((r,h)=>h!==a))},_=a=>{if(a.target.files&&a.target.files[0]){const s=a.target.files[0];$(s),H(URL.createObjectURL(s))}},K=()=>{$(null),H(null),k(a=>({...a,imageUrl:""}))},X=a=>{if(a.target.files){const t=Array.from(a.target.files).map(r=>({id:Math.random().toString(36).substr(2,9),file:r,preview:URL.createObjectURL(r)}));g(r=>[...r,...t])}},Y=a=>{g(s=>{const t=s.find(r=>r.id===a);return t&&URL.revokeObjectURL(t.preview),s.filter(r=>r.id!==a)})},ee=async()=>{if(!G){alert("Error: No se ha seleccionado un emprendimiento válido.");return}E(!0);try{let a=p.imageUrl;if(z)try{a=(await B.uploadImage("/upload/image",z,{type:"supply-chain"})).url}catch(t){console.error("Error uploading sc image",t)}const s=[];for(const t of F)try{const r=await B.uploadImage("/upload/image",t.file,{type:"annex"});s.push(r.url)}catch(r){console.error("Error uploading annex",r)}await B.createPlan({entrepreneurshipId:G,...o,team:u,partners:f,segments:m,supplyChain:{...p,imageUrl:a},annexes:s,rates:{growthRate:parseFloat(c.growthRate)/100,priceGrowthRate:parseFloat(c.priceGrowthRate)/100,discountRate:parseFloat(c.discountRate)/100,inflationRate:parseFloat(c.inflationRate)/100,salaryIncreaseRate:parseFloat(c.salaryIncreaseRate)/100},demands:j,equipments:x,unitCosts:I,provisions:b,financing:R}),window.location.href="/dashboard"}catch(a){console.error("Submission error:",a),alert("Error al guardar el plan.")}finally{E(!1)}},ae=()=>{switch(d){case 1:return e.jsxs("div",{className:"space-y-6",children:[e.jsx(n,{label:"Descripción general del negocio",isTextArea:!0,value:o.businessDescription,onChange:a=>v("businessDescription",a.target.value)}),e.jsx(n,{label:"Actividad principal",isTextArea:!0,value:o.mainActivity,onChange:a=>v("mainActivity",a.target.value)}),e.jsx(n,{label:"Enfoque productivo o comercial",isTextArea:!0,value:o.productiveFocus,onChange:a=>v("productiveFocus",a.target.value)})]});case 2:return e.jsxs("div",{className:"space-y-6",children:[e.jsx(n,{label:"Propuesta de valor principal",isTextArea:!0,value:o.valueProposition,onChange:a=>v("valueProposition",a.target.value)}),e.jsx(n,{label:"Diferenciación frente a la competencia",isTextArea:!0,value:o.differentiation,onChange:a=>v("differentiation",a.target.value)}),e.jsx(n,{label:"Beneficios para el cliente",isTextArea:!0,value:o.customerBenefits,onChange:a=>v("customerBenefits",a.target.value)})]});case 3:return e.jsx("div",{className:"space-y-8",children:e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-800 mb-4",children:"Integrantes del Equipo"}),u.map((a,s)=>e.jsxs("div",{className:"grid grid-cols-12 gap-4 mb-4 bg-slate-50 p-4 rounded-lg",children:[e.jsx("div",{className:"col-span-4",children:e.jsx(n,{label:"Nombre",value:a.name,onChange:t=>l(s,"name",t.target.value,w,u)})}),e.jsx("div",{className:"col-span-4",children:e.jsx(n,{label:"Rol",value:a.role,onChange:t=>l(s,"role",t.target.value,w,u)})}),e.jsx("div",{className:"col-span-3",children:e.jsx(n,{label:"Experiencia",value:a.experience,onChange:t=>l(s,"experience",t.target.value,w,u)})}),e.jsx("div",{className:"col-span-1 border-l flex items-center justify-center",children:e.jsx("button",{onClick:()=>C(s,w,u),className:"text-red-500",children:"✕"})})]},a.id)),e.jsx("button",{onClick:()=>y(w,u,{name:"",experience:"",role:""}),className:"text-primary-600 font-bold",children:"+ Agregar Integrante"})]})});case 4:return e.jsx("div",{className:"space-y-6",children:e.jsx(n,{label:"Canales de Comunicación (Ej: Redes Sociales, Ferias, Contacto Directo)",isTextArea:!0,value:o.communicationChannels,onChange:a=>v("communicationChannels",a.target.value)})});case 5:return e.jsx("div",{className:"space-y-6",children:e.jsx(n,{label:"Canales de Comercialización (Ej: Venta Directa, Distribuidores, Online)",isTextArea:!0,value:o.commercializationChannels,onChange:a=>v("commercializationChannels",a.target.value)})});case 6:return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"font-bold text-slate-800 mb-4",children:"Socios Clave"}),f.map((a,s)=>e.jsxs("div",{className:"grid grid-cols-12 gap-4 mb-4 bg-slate-50 p-4 rounded-lg",children:[e.jsx("div",{className:"col-span-4",children:e.jsx(n,{label:"Nombre",value:a.name,onChange:t=>l(s,"name",t.target.value,N,f)})}),e.jsx("div",{className:"col-span-4",children:e.jsx(n,{label:"Tipo",select:!0,options:[{label:"Proveedor",value:"PROVEEDOR"},{label:"Institución",value:"INSTITUCION"},{label:"Aliado",value:"ALIADO"}],value:a.type,onChange:t=>l(s,"type",t.target.value,N,f)})}),e.jsx("div",{className:"col-span-3",children:e.jsx(n,{label:"Rol",value:a.role,onChange:t=>l(s,"role",t.target.value,N,f)})}),e.jsx("div",{className:"col-span-1 border-l flex items-center justify-center",children:e.jsx("button",{onClick:()=>C(s,N,f),className:"text-red-500",children:"✕"})})]},a.id)),e.jsx("button",{onClick:()=>y(N,f,{name:"",type:"PROVEEDOR",role:""}),className:"text-primary-600 font-bold",children:"+ Agregar Socio"})]});case 7:return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"font-bold text-slate-800 mb-4",children:"Segmentos de Clientes"}),m.map((a,s)=>e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg mb-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-2",children:[e.jsx(n,{label:"Nombre del segmento",value:a.name,onChange:t=>l(s,"name",t.target.value,P,m)}),e.jsx(n,{label:"Porcentaje (%)",type:"number",value:a.percentage,onChange:t=>l(s,"percentage",t.target.value,P,m)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-2",children:[e.jsx(n,{label:"Rango de Edad",value:a.ageRange,onChange:t=>l(s,"ageRange",t.target.value,P,m)}),e.jsx(n,{label:"Nivel Socioeconómico",select:!0,options:[{label:"A",value:"A"},{label:"B",value:"B"},{label:"C+",value:"C+"},{label:"C-",value:"C-"}],value:a.socioeconomicLevel,onChange:t=>l(s,"socioeconomicLevel",t.target.value,P,m)})]}),e.jsx(n,{label:"Características",isTextArea:!0,value:a.characteristics,onChange:t=>l(s,"characteristics",t.target.value,P,m)}),e.jsx("button",{onClick:()=>C(s,P,m),className:"text-red-500 text-sm mt-2 font-bold",children:"Quitar Segmento"})]},a.id)),e.jsx("button",{onClick:()=>y(P,m,{name:"",percentage:"",ageRange:"",socioeconomicLevel:"C",characteristics:""}),className:"text-primary-600 font-bold",children:"+ Agregar Segmento"})]});case 8:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex bg-slate-100 p-1 rounded-xl mb-6",children:[e.jsx("button",{onClick:()=>v("supplyChainMode","GUIDED"),className:`flex-1 py-3 text-sm font-bold rounded-lg transition-all ${o.supplyChainMode==="GUIDED"?"bg-white text-indigo-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Modo Guiado (Texto)"}),e.jsx("button",{onClick:()=>v("supplyChainMode","IMAGE"),className:`flex-1 py-3 text-sm font-bold rounded-lg transition-all ${o.supplyChainMode==="IMAGE"?"bg-white text-indigo-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Diagrama (Imagen)"})]}),o.supplyChainMode==="GUIDED"?e.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-bottom-2",children:[e.jsx(n,{label:"Proveedores",value:p.providers,onChange:a=>k({...p,providers:a.target.value})}),e.jsx(n,{label:"Producción",value:p.production,onChange:a=>k({...p,production:a.target.value})}),e.jsx(n,{label:"Almacenamiento",value:p.storage,onChange:a=>k({...p,storage:a.target.value})}),e.jsx(n,{label:"Distribución",value:p.distribution,onChange:a=>k({...p,distribution:a.target.value})}),e.jsx(n,{label:"Cliente final",value:p.client,onChange:a=>k({...p,client:a.target.value})})]}):e.jsx("div",{className:"space-y-4 animate-in fade-in slide-in-from-bottom-2",children:e.jsx("div",{className:"p-8 border-2 border-dashed border-slate-200 rounded-2xl flex flex-col items-center justify-center bg-slate-50 hover:bg-slate-100 transition-colors",children:W?e.jsxs("div",{className:"text-center w-full",children:[e.jsx("img",{src:W,alt:"Diagrama Preview",className:"h-48 mx-auto object-contain mb-4 bg-white p-2 rounded shadow-sm"}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsxs("label",{className:"btn btn-sm btn-outline cursor-pointer bg-white",children:["Cambiar Imagen",e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:_})]}),e.jsx("button",{onClick:K,className:"btn btn-sm btn-error btn-outline bg-white",children:"Eliminar"})]})]}):e.jsxs("label",{className:"cursor-pointer text-center w-full py-8",children:[e.jsx("div",{className:"bg-white p-4 rounded-full shadow-sm inline-block mb-3",children:e.jsx("svg",{className:"w-8 h-8 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("div",{className:"font-bold text-slate-700",children:"Subir Diagrama"}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:_})]})})})]});case 9:return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsx(n,{label:"Tasa de Crecimiento anual (%)",type:"number",value:c.growthRate,onChange:a=>T({...c,growthRate:a.target.value})}),e.jsx(n,{label:"Tasa Crecimiento de Precio (%)",type:"number",value:c.priceGrowthRate,onChange:a=>T({...c,priceGrowthRate:a.target.value})}),e.jsx(n,{label:"Tasa de Descuento (%)",type:"number",value:c.discountRate,onChange:a=>T({...c,discountRate:a.target.value})}),e.jsx(n,{label:"Tasa de Inflación (%)",type:"number",value:c.inflationRate,onChange:a=>T({...c,inflationRate:a.target.value})}),e.jsx(n,{label:"Incremento salarial anual (%)",className:"col-span-2",type:"number",value:c.salaryIncreaseRate,onChange:a=>T({...c,salaryIncreaseRate:a.target.value})})]})});case 10:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center bg-slate-900 text-white p-4 rounded-xl",children:[e.jsx("span",{className:"font-bold",children:"Ingresos Mensuales Estimados"}),e.jsxs("span",{className:"text-xl font-mono text-green-400",children:["$",Z.monthlyRevenue.toFixed(2)]})]}),j.map((a,s)=>e.jsxs("div",{className:"grid grid-cols-12 gap-4 bg-slate-50 p-4 rounded-lg items-end",children:[e.jsx("div",{className:"col-span-6",children:e.jsx(n,{label:"Producto",value:a.productName,onChange:t=>l(s,"productName",t.target.value,L,j)})}),e.jsx("div",{className:"col-span-2",children:e.jsx(n,{label:"Demanda Mes",type:"number",value:a.monthlyDemand,onChange:t=>l(s,"monthlyDemand",t.target.value,L,j)})}),e.jsx("div",{className:"col-span-3",children:e.jsx(n,{label:"Precio Unitario",type:"number",value:a.unitPrice,onChange:t=>l(s,"unitPrice",t.target.value,L,j)})}),e.jsx("div",{className:"col-span-1 flex justify-center",children:e.jsx("button",{onClick:()=>C(s,L,j),className:"text-red-500",children:"✕"})})]},a.id)),e.jsx("button",{onClick:()=>y(L,j,{productName:"",monthlyDemand:"",unitPrice:""}),className:"font-bold text-primary-600",children:"+ Agregar Producto"})]});case 11:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center bg-slate-900 text-white p-4 rounded-xl",children:[e.jsx("span",{className:"font-bold",children:"Inversión Inicial en Equipos"}),e.jsxs("span",{className:"text-xl font-mono text-blue-400",children:["$",Z.investment.toFixed(2)]})]}),x.map((a,s)=>e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-4 items-end",children:[e.jsx("div",{className:"col-span-5",children:e.jsx(n,{label:"Descripción",value:a.description,onChange:t=>l(s,"description",t.target.value,S,x)})}),e.jsx("div",{className:"col-span-2",children:e.jsx(n,{label:"Cantidad",type:"number",value:a.quantity,onChange:t=>l(s,"quantity",parseInt(t.target.value),S,x)})}),e.jsx("div",{className:"col-span-4",children:e.jsx(n,{label:"Precio Unitario",type:"number",value:a.unitPrice,onChange:t=>l(s,"unitPrice",t.target.value,S,x)})}),e.jsx("div",{className:"col-span-1 flex justify-center",children:e.jsx("button",{onClick:()=>C(s,S,x),className:"text-red-500",children:"✕"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 border-t pt-4",children:[e.jsx(n,{label:"Tipo de Cuenta",select:!0,options:[{label:"Maquinaria",value:"Maquinaria"},{label:"Muebles y Enseres",value:"Muebles"},{label:"Software",value:"Software"},{label:"Otros",value:"Otros"}],value:a.accountType,onChange:t=>l(s,"accountType",t.target.value,S,x)}),e.jsx(n,{label:"Financiamiento",select:!0,options:[{label:"Propio",value:"Propio"},{label:"Préstamo",value:"Prestamo"},{label:"Donación",value:"Donacion"}],value:a.financingSource,onChange:t=>l(s,"financingSource",t.target.value,S,x)})]})]},a.id)),e.jsx("button",{onClick:()=>y(S,x,{description:"",quantity:1,unitPrice:"",accountType:"Maquinaria",financingSource:"Propio"}),className:"font-bold text-primary-600",children:"+ Agregar Activo"})]});case 12:return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"font-bold text-slate-800 mb-4",children:"Costos Unitarios de Producción"}),I.map((a,s)=>e.jsxs("div",{className:"grid grid-cols-12 gap-4 mb-4 bg-slate-50 p-4 rounded-lg items-end",children:[e.jsx("div",{className:"col-span-5",children:e.jsx(n,{label:"Producto",value:a.productName,onChange:t=>l(s,"productName",t.target.value,M,I)})}),e.jsx("div",{className:"col-span-3",children:e.jsx(n,{label:"Cantidad Mensual",type:"number",value:a.monthlyQuantity,onChange:t=>l(s,"monthlyQuantity",t.target.value,M,I)})}),e.jsx("div",{className:"col-span-3",children:e.jsx(n,{label:"Costo Unitario",type:"number",value:a.unitCost,onChange:t=>l(s,"unitCost",t.target.value,M,I)})}),e.jsx("div",{className:"col-span-1 flex justify-center",children:e.jsx("button",{onClick:()=>C(s,M,I),className:"text-red-500",children:"✕"})})]},a.id)),e.jsx("button",{onClick:()=>y(M,I,{productName:"",monthlyQuantity:"",unitCost:""}),className:"font-bold text-primary-600",children:"+ Agregar Costo Unitario"})]});case 13:return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"font-bold text-slate-800 mb-4",children:"Provisiones de Gastos (Fijos/Operativos)"}),b.map((a,s)=>e.jsxs("div",{className:"grid grid-cols-12 gap-3 mb-3 bg-slate-50 p-4 rounded-lg items-end",children:[e.jsx("div",{className:"col-span-4",children:e.jsx(n,{label:"Ítem",value:a.item,onChange:t=>l(s,"item",t.target.value,A,b)})}),e.jsx("div",{className:"col-span-2",children:e.jsx(n,{label:"Unidad",placeholder:"kg, lt, mes",value:a.unit,onChange:t=>l(s,"unit",t.target.value,A,b)})}),e.jsx("div",{className:"col-span-2",children:e.jsx(n,{label:"Cant. Mensual",type:"number",value:a.monthlyQuantity,onChange:t=>l(s,"monthlyQuantity",t.target.value,A,b)})}),e.jsx("div",{className:"col-span-3",children:e.jsx(n,{label:"Precio Unitario",type:"number",value:a.unitPrice,onChange:t=>l(s,"unitPrice",t.target.value,A,b)})}),e.jsx("div",{className:"col-span-1 flex justify-center",children:e.jsx("button",{onClick:()=>C(s,A,b),className:"text-red-500",children:"✕"})})]},a.id)),e.jsx("button",{onClick:()=>y(A,b,{item:"",unit:"",monthlyQuantity:"",unitPrice:""}),className:"font-bold text-primary-600",children:"+ Agregar Provisión"})]});case 14:return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"font-bold text-slate-800 mb-4",children:"Estructura de Financiamiento"}),R.map((a,s)=>e.jsxs("div",{className:"grid grid-cols-12 gap-4 bg-slate-50 p-4 rounded-lg items-end mb-4",children:[e.jsx("div",{className:"col-span-5",children:e.jsx(n,{label:"Concepto",value:a.concept,onChange:t=>l(s,"concept",t.target.value,U,R)})}),e.jsx("div",{className:"col-span-3",children:e.jsx(n,{label:"Monto",type:"number",value:a.amount,onChange:t=>l(s,"amount",t.target.value,U,R)})}),e.jsx("div",{className:"col-span-3",children:e.jsx(n,{label:"Fuente",select:!0,options:[{label:"Propia",value:"Propia"},{label:"Préstamo",value:"Prestamo"},{label:"Donación",value:"Donacion"}],value:a.source,onChange:t=>l(s,"source",t.target.value,U,R)})}),e.jsx("div",{className:"col-span-1 flex justify-center",children:e.jsx("button",{onClick:()=>C(s,U,R),className:"text-red-500",children:"✕"})})]},a.id)),e.jsx("button",{onClick:()=>y(U,R,{concept:"",amount:"",source:"Propia"}),className:"font-bold text-primary-600",children:"+ Agregar Rubro"})]});case 15:return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"p-8 border-2 border-dashed border-slate-200 rounded-2xl flex flex-col items-center justify-center bg-slate-50",children:e.jsxs("label",{className:"cursor-pointer text-center w-full py-4",children:[e.jsx("div",{className:"bg-white p-4 rounded-full shadow-sm inline-block mb-3",children:e.jsx("svg",{className:"w-8 h-8 text-primary-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})})}),e.jsx("div",{className:"font-bold text-slate-700",children:"Subir Imágenes de Evidencia"}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"Fotos, capturas o documentos gráficos"}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",multiple:!0,onChange:X})]})}),F.length>0&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-6",children:F.map(a=>e.jsxs("div",{className:"relative group rounded-xl overflow-hidden border border-slate-200 shadow-sm bg-white p-2",children:[e.jsx("img",{src:a.preview,alt:"Annex Preview",className:"h-24 w-full object-cover rounded-lg"}),e.jsx("button",{onClick:()=>Y(a.id),className:"absolute -top-1 -right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity shadow-md",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]},a.id))}),e.jsxs("div",{className:"bg-indigo-900 text-white p-6 rounded-2xl mt-8",children:[e.jsx("h3",{className:"font-bold text-lg mb-2",children:"Finalizar Registro"}),e.jsx("p",{className:"text-sm opacity-80 leading-relaxed",children:"Al presionar el botón de abajo, se procesarán todos los cálculos financieros (VAN, TIR, Flujo de Caja) y se generará tu reporte completo."})]})]});default:return null}};return e.jsxs("div",{className:"flex flex-col space-y-8",children:[e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"flex justify-between items-center max-w-4xl mx-auto px-4 py-2 overflow-x-auto",children:q.map((a,s)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full border-2 font-bold transition-all ${d===a.id?"border-indigo-600 bg-indigo-600 text-white":d>a.id?"border-green-500 bg-green-500 text-white":"border-slate-300 text-slate-400"}`,onClick:()=>D(a.id),children:d>a.id?"✓":a.id}),e.jsx("span",{className:`ml-2 text-sm font-bold whitespace-nowrap hidden md:block ${d===a.id?"text-indigo-900":"text-slate-500"}`,children:a.title}),s<q.length-1&&e.jsx("div",{className:`w-12 h-0.5 mx-4 ${d>a.id?"bg-green-500":"bg-slate-300"}`})]},a.id))})}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"max-w-4xl mx-auto bg-white rounded-2xl shadow-xl shadow-slate-200/50 border border-slate-100 overflow-hidden",children:[e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-2xl font-black text-slate-900 tracking-tight mb-2",children:q[d-1].title}),e.jsx("p",{className:"text-slate-500 font-medium",children:q[d-1].description})]}),ae()]}),e.jsxs("div",{className:"px-8 py-6 bg-slate-50 border-t border-slate-100 flex justify-between items-center",children:[e.jsx("button",{disabled:d===1,onClick:()=>D(a=>a-1),className:`btn btn-secondary ${d===1?"invisible":""}`,children:"Atrás"}),d<q.length?e.jsx("button",{onClick:()=>D(a=>a+1),className:"btn btn-primary px-10",children:"Siguiente"}):e.jsx("button",{onClick:ee,disabled:O,className:"btn bg-green-600 hover:bg-green-700 text-white px-10 shadow-lg shadow-green-200",children:O?"Guardando...":"Finalizar y Guardar Plan"})]})]})})]})},ie=()=>{const[G,d]=i.useState("SELECT"),[D,O]=i.useState([]),[E,o]=i.useState(null),[V,F]=i.useState(!0);return i.useEffect(()=>{(async()=>{try{const u=await B.getEntrepreneurships(),w=Array.isArray(u)?u:u.entrepreneurships||[];O(w);const N=new URLSearchParams(window.location.search).get("entId");if(N){const m=parseInt(N);isNaN(m)||(o(m),d("WIZARD"))}}catch(u){console.error("Error loading entrepreneurships",u)}finally{F(!1)}})()},[]),V?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-indigo-500 border-t-transparent"}),e.jsx("p",{className:"mt-4 text-slate-500",children:"Cargando datos..."})]})}):G==="SELECT"?e.jsx("div",{className:"max-w-xl mx-auto pt-20 px-6",children:e.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-lg border border-slate-100 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-4",children:"Crear Nuevo Plan Económico"}),e.jsx("p",{className:"text-slate-500 mb-8",children:"Primero, selecciona el Emprendimiento al que pertenece este plan."}),D.length===0?e.jsxs("div",{className:"alert bg-yellow-50 border-yellow-200 text-yellow-800 p-4 rounded-lg",children:[e.jsx("div",{className:"font-bold mb-2",children:"No tienes emprendimientos registrados."}),e.jsx("div",{className:"text-sm mb-4",children:"Debes crear uno antes de hacer un plan económico."}),e.jsx("div",{className:"flex justify-center",children:e.jsx("a",{href:"/entrepreneurship/create",className:"btn btn-primary btn-sm inline-block shadow-md",children:"Crear Emprendimiento"})})]}):e.jsxs("div",{className:"space-y-4 text-left",children:[e.jsx("label",{className:"block font-medium text-slate-700",children:"Seleccionar Proyecto:"}),e.jsxs("select",{className:"select input w-full text-lg border-slate-300",onChange:g=>o(parseInt(g.target.value)),defaultValue:"",children:[e.jsx("option",{value:"",disabled:!0,children:"-- Elige un proyecto --"}),D.map(g=>e.jsxs("option",{value:g.id,children:[g.name," (",g.sector,")"]},g.id))]}),e.jsx("button",{className:`btn btn-primary btn-sm w-full mt-4 ${E?"":"opacity-50 cursor-not-allowed"}`,disabled:!E,onClick:()=>d("WIZARD"),children:"Continuar al Plan Financiero"})]})]})}):e.jsx(te,{entrepreneurshipId:E})};export{ie as PlanCreationContainer};
