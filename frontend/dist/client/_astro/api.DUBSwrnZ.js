const u="http://localhost:3000/api";class c{constructor(e){this.baseUrl=e}getToken(){return typeof window<"u"?localStorage.getItem("token"):null}getHeaders(){const e={"Content-Type":"application/json"},t=this.getToken();return t&&(e.Authorization=`Bearer ${t}`),e}async request(e,t={}){const s=new AbortController,a=setTimeout(()=>s.abort(),8e3),i=`${this.baseUrl}${e}`,o={...t,signal:s.signal,headers:{...this.getHeaders(),...t.headers}};try{const r=await fetch(i,o),n=await r.json();if(!r.ok)throw new Error(n.error||"Request failed");return n}catch(r){throw r.name==="AbortError"?new Error("Server not responding"):r}finally{clearTimeout(a)}}async register(e){return this.request("/auth/register",{method:"POST",body:JSON.stringify(e)})}async login(e){const t=await this.request("/auth/login",{method:"POST",body:JSON.stringify(e)});return t.token&&typeof window<"u"&&(localStorage.setItem("token",t.token),localStorage.setItem("user",JSON.stringify(t.user))),t}logout(){typeof window<"u"&&(localStorage.removeItem("token"),localStorage.removeItem("user"))}async verifyPassword(e){return this.request("/auth/verify-password",{method:"POST",body:JSON.stringify({password:e})})}async getProfile(){return this.request("/users/me")}async updateProfile(e){return this.request("/users/me",{method:"PUT",body:JSON.stringify(e)})}async changePassword(e){return this.request("/users/me/password",{method:"PUT",body:JSON.stringify(e)})}async createEntrepreneurship(e){return this.request("/entrepreneurships",{method:"POST",body:JSON.stringify(e)})}async getEntrepreneurships(){return this.request("/entrepreneurships")}async getEntrepreneurship(e){return this.request(`/entrepreneurships/${e}`)}async updateEntrepreneurship(e,t){return this.request(`/entrepreneurships/${e}`,{method:"PUT",body:JSON.stringify(t)})}async deleteEntrepreneurship(e){return this.request(`/entrepreneurships/${e}`,{method:"DELETE"})}async createPlan(e){return this.request("/plans",{method:"POST",body:JSON.stringify(e)})}async getPlans(){return this.request("/plans")}async getPlan(e){return this.request(`/plans/${e}`)}async updatePlan(e,t){return this.request(`/plans/${e}`,{method:"PUT",body:JSON.stringify(t)})}async deletePlan(e){return this.request(`/plans/${e}`,{method:"DELETE"})}async deleteDocument(e){return this.request(`/documents/${e}`,{method:"DELETE"})}async exportPlan(e){const t=this.getToken(),s=`${this.baseUrl}/plans/${e}/export`,i=await(await fetch(s,{method:"POST",headers:{Authorization:`Bearer ${t}`}})).arrayBuffer(),o=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),r=window.URL.createObjectURL(o),n=document.createElement("a");n.href=r,n.download="plan_economico.docx",document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(r)}async uploadImage(e,t,s={}){const a=new FormData;s.type&&a.append("type",s.type),a.append("image",t);const i=this.getToken(),o=await fetch(`${this.baseUrl}${e}`,{method:"POST",headers:{...i&&{Authorization:`Bearer ${i}`}},body:a});if(!o.ok){const r=await o.json().catch(()=>({error:"Error in upload"}));throw new Error(r.error||"Error in upload")}return o.json()}}const h=new c(u);export{h as a};
