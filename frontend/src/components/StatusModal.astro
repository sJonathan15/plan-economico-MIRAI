---
interface Props {
    id: string;
}

const { id } = Astro.props;
---

<dialog id={id} class="status-modal group">
    <div
        class="fixed inset-0 bg-black/40 backdrop-blur-[2px] opacity-0 group-[[open]]:opacity-100 transition-opacity duration-300"
    >
    </div>
    <div
        class="modal-content relative bg-white p-8 rounded-[24px] flex flex-col items-center text-center max-w-sm w-full mx-auto transform scale-95 opacity-0 group-[[open]]:scale-100 group-[[open]]:opacity-100 transition-all duration-300 ease-out shadow-2xl"
    >
        >
        <!-- Icon Container -->
        <div
            id={`${id}-icon-container`}
            class="w-20 h-20 rounded-3xl flex items-center justify-center mb-6 transition-colors duration-300"
        >
            <!-- Icons will be injected here via JS -->
            <div id={`${id}-icon`}></div>
        </div>

        <!-- Content -->
        <h3
            id={`${id}-title`}
            class="text-2xl font-black text-slate-900 mb-3 tracking-tight"
        >
        </h3>
        <p
            id={`${id}-message`}
            class="text-slate-500 font-medium mb-8 leading-relaxed"
        >
        </p>

        <!-- Action Button -->
        <button
            type="button"
            class="btn-close-status-modal btn btn-primary w-full py-4 shadow-lg shadow-indigo-500/10"
        >
            Cerrar
        </button>
    </div>
</dialog>

<style>
    .status-modal {
        background: transparent;
        border: none;
        padding: 0;
        max-width: none;
        max-height: none;
        width: 100%;
        height: 100%;
        align-items: center;
        justify-content: center;
    }

    .status-modal[open] {
        display: flex;
    }

    /* Success State */
    .status-modal.success #icon-container {
        @apply bg-emerald-50 text-emerald-600;
    }

    /* Error State */
    .status-modal.error #icon-container {
        @apply bg-red-50 text-red-600;
    }

    /* Warning State */
    .status-modal.warning #icon-container {
        @apply bg-amber-50 text-amber-600;
    }

    /* Prevent scrolling when open */
    :global(body:has(dialog[open].status-modal)) {
        overflow: hidden;
    }
</style>

<script is:inline define:vars={{ componentId: id }}>
    window.AstroStatusModal = window.AstroStatusModal || {};

    window.AstroStatusModal[componentId] = {
        show: (config) => {
            const modal = document.getElementById(componentId);
            const titleEl = document.getElementById(`${componentId}-title`);
            const messageEl = document.getElementById(`${componentId}-message`);
            const iconContainer = document.getElementById(
                `${componentId}-icon-container`,
            );
            const iconEl = document.getElementById(`${componentId}-icon`);

            const { title, message, type = "error" } = config;

            // Reset classes
            modal.classList.remove("success", "error", "warning");
            modal.classList.add(type);

            // Icons Mapping
            const icons = {
                success: `<svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M5 13l4 4L19 7"></path></svg>`,
                error: `<svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M6 18L18 6M6 6l12 12"></path></svg>`,
                warning: `<svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>`,
            };

            // Styles Mapping
            const styles = {
                success: { bg: "bg-emerald-50", text: "text-emerald-600" },
                error: { bg: "bg-red-50", text: "text-red-600" },
                warning: { bg: "bg-amber-50", text: "text-amber-600" },
            };

            // Apply Content
            titleEl.innerText = title;
            messageEl.innerText = message;
            iconEl.innerHTML = icons[type];

            // Apply Styles
            iconContainer.className = `w-20 h-20 rounded-3xl flex items-center justify-center mb-6 ${styles[type].bg} ${styles[type].text}`;

            modal.showModal();
        },
        hide: () => {
            const modal = document.getElementById(componentId);
            modal.close();
        },
    };

    document.querySelectorAll(".btn-close-status-modal").forEach((btn) => {
        btn.addEventListener("click", () => {
            const modal = btn.closest("dialog");
            modal.close();
        });
    });
</script>
